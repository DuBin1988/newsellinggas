<UserControl
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:a="clr-namespace:Com.Aote.Attachs;assembly=s2DLL"
    xmlns:o="clr-namespace:Com.Aote.ObjectTools;assembly=s2DLL"
    xmlns:oo="clr-namespace:Com.Aote.ObjectTools"
    xmlns:b="clr-namespace:Com.Aote.Behaviors;assembly=s2DLL"
	xmlns:c="clr-namespace:Com.Aote.Controls;assembly=s2DLL"
    xmlns:m="clr-namespace:Com.Aote.Marks;assembly=s2DLL"
    xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
    xmlns:ei="http://schemas.microsoft.com/expression/2010/interactions"
    xmlns:data="clr-namespace:System.Windows.Data;assembly=System.Windows"
    xmlns:sdk="http://schemas.microsoft.com/winfx/2006/xaml/presentation/sdk"
    xmlns:toolkit="http://schemas.microsoft.com/winfx/2006/xaml/presentation/toolkit"
	mc:Ignorable="d" FontSize="13"
	x:Class="Com.Aote.Pages.阶梯发卡售气" FontFamily="Microsoft YaHei">

    <Grid x:Name="LayoutRoot">
        <m:ResourceLoad x:Name="loader" Margin="0,0,-101,0">

            <!--发卡费-->
            <o:GeneralObject Name="fakafei" EntityType="t_singlevalue" WebClientInfo="{StaticResource dbclient}"
		    IsInit="{m:Exp Str='userfiles.ItemsSource.State==$End$ |or| print.State==$End$'}"
		  	Path="{m:Exp Str=userfiles.SelectedItem.f_userid \!\= null:$one/from t_singlevalue where name \= \'\{LoginUser.f_fengongsi\}\{userfiles.SelectedItem.f_usertype\}\发\卡\费\'$\,$null$}">
            </o:GeneralObject>

            <!--非民用限购参数对象-->
            <o:GeneralObject Name="gsxiangou" EntityType="t_gsxiangou" WebClientInfo="{StaticResource dbclient}"
            Path="{m:Exp Str=$one/from t_gsxiangou where f_fanwei &lt;\= \{userfiles1.f_flownum\} and f_daofanwei &gt; \{userfiles1.f_flownum\}}">
            </o:GeneralObject>

            <!--收费类型-->
            <o:ObjectList Name="payfeetypelist" WebClientInfo="{StaticResource dbclient}" Path="from paramvalue where param.name='发卡售气收费类型' order by id"/>
            <!--付款方式-->
            <o:ObjectList Name="paylist" WebClientInfo="{StaticResource dbclient}" Path="from paramvalue where param.name='付款方式' order by id"/>
            <!--打开窗口对象-->
            <o:ChildWindowObj Name="openkafei"  CWName="/Pages/高级管理员登录" />
            <o:ChildWindowObj Name="openxiangou" CWName="/Pages/管理员登录" />

            <!--混合气价对象 -->
            <o:GeneralObject Name="hunhes" EntityType="t_hunhe" WebClientInfo="{StaticResource dbclient}"
        	Path="{m:Exp Str=$one/from t_hunhe }">
            </o:GeneralObject>

            <!--用户对象-->
            <o:GeneralObject Name="userfiles1" EntityType="t_userfiles" WebClientInfo="{StaticResource dbclient}"
        IsInit="{m:Exp Str='SaveAction\=\=$Error$ |or| card.State\=\=$Error$ |or| print.State==$End$'}"
		Path="{m:Exp Str=userfiles.SelectedItem!\=null:$one/from t_userfiles where f_userid\=\'\{userfiles.SelectedItem.f_userid\}\'$\,$null$}">
                <o:PropertySetter PropertyName="f_finallybought" Value="{m:Exp Str=userfile.DataContext.f_pregas}" />
                <o:PropertySetter PropertyName="sxrq" Value="{m:Exp Str='SysTime.Today.ToString($yyyyMMdd$)'}" />
                <o:PropertySetter PropertyName="sxbj" Value="1" />
                <o:PropertySetter PropertyName="f_zherownum" NoDependValue="13" Default="13"/>
                <o:PropertySetter PropertyName="oldprice" Default="198" />
                <o:PropertySetter PropertyName="newprice" Value="198" />
                <o:PropertySetter PropertyName="yhh" Value="1111111111" />
                <o:PropertySetter PropertyName="f_zhye" 
				NoDependValue="{m:Exp Str=SaveAction\=>Saving!\=null:userfile.DataContext.f_givechange\,null}"/>
                <!--维护费起始月份-->
                <o:PropertySetter PropertyName="f_beginfee" 
			NoDependValue="{m:Exp Str=SaveAction\=>Saving!\=null:userfile.DataContext.f_beginfee\,null}" />
                <o:PropertySetter PropertyName="f_cardid" Value="{m:Exp Str='userfile.DataContext.f_cardid !\=null:userfile.DataContext.f_cardid\,null'}" />
                <o:PropertySetter PropertyName="f_times" 
			Value="{m:Exp Str='card.State==$Error$:0,1'}" />
                <!--平价气累计购气量-->
                <o:PropertySetter PropertyName="f_OrdinaryNum" 
				NoDependValue="{m:Exp Str=SaveAction\=>Saving!\=null:userfile.DataContext.f_OrdinaryNum\,null}"/>

                <!--上次购气量f_ThePreGas-->
                <o:PropertySetter PropertyName="f_ThePreGas"   
				Value="{m:Exp Str=userfile.DataContext.f_pregas}"/>

                <!--上上次购气量f_LastPreGas-->
                <o:PropertySetter PropertyName="f_LastPreGas"   
				Default="0"/>
                <!--上上上次购气量f_LastLastPreGas-->
                <o:PropertySetter PropertyName="f_LastLastPreGas"   
				Default="0"/>
            </o:GeneralObject>
            <!--收费对象-->
            <o:GeneralObject Name="sellgasobj" EntityType="t_sellinggas" WebClientInfo="{StaticResource dbclient}"
		IsInit="{m:Exp Str='SaveAction\=\=$Error$ |or| card.State\=\=$Error$ |or| print.State==$End$'}">
                <o:PropertySetter PropertyName="f_username" Value="{m:Exp Str=userfile.DataContext.f_username}"/>
                <o:PropertySetter PropertyName="f_districtname" Value="{m:Exp Str=userfile.DataContext.f_districtname}"/>
                <o:PropertySetter PropertyName="f_apartment" Value="{m:Exp Str=userfile.DataContext.f_apartment}"/>
                <o:PropertySetter PropertyName="f_address" Value="{m:Exp Str=userfile.DataContext.f_address}" />
                <o:PropertySetter PropertyName="f_gaswatchbrand" Value="{m:Exp Str=userfile.DataContext.f_gaswatchbrand}" />
                <o:PropertySetter PropertyName="f_metertype" Value="{m:Exp Str=userfile.DataContext.f_metertype}" />
                <o:PropertySetter PropertyName="f_gasmetermanufacturers" Value="{m:Exp Str=userfile.DataContext.f_gasmetermanufacturers}" />
                <o:PropertySetter PropertyName="f_meternumber" Value="{m:Exp Str=userfile.DataContext.f_meternumber}" />
                <o:PropertySetter PropertyName="f_userid" Value="{m:Exp Str=userfile.DataContext.f_userid}" />
                <o:PropertySetter PropertyName="f_singlegasnum" Value="{m:Exp Str=userfile.DataContext.f_singlegasnum}" />
                <o:PropertySetter PropertyName="f_pregas" Value="{m:Exp Str=userfile.DataContext.f_pregas}" />

                <o:PropertySetter PropertyName="f_upbuynum" Value="{m:Exp Str=userfile.DataContext.f_upbuynum}" />
                <o:PropertySetter PropertyName="f_premetergasnums" Value="{m:Exp Str=userfile.DataContext.f_premetergasnums}" />
                <o:PropertySetter PropertyName="f_limitbuygas" Value="{m:Exp Str=userfile.DataContext.f_limitbuygas}" />

                <o:PropertySetter PropertyName="f_givechange" Value="{m:Exp Str=userfile.DataContext.f_givechange}" />
                <o:PropertySetter PropertyName="f_payment" Value="{m:Exp Str=userfile.DataContext.f_payment}" />
                <o:PropertySetter PropertyName="f_buka" Value="否" />
                <!--公司类型-->
                <o:PropertySetter PropertyName="f_comtype" Value="天然气公司" />
                <!--是否有效-->
                <o:PropertySetter PropertyName="f_payfeevalid" Value="有效" />
                <!--别名f_aliasname-->
                <o:PropertySetter PropertyName="f_aliasname" Value="{m:Exp Str=userfile.DataContext.f_aliasname}" />
                <!--卡号f_cardid-->
                <o:PropertySetter PropertyName="f_cardid" Value="{m:Exp Str=userfile.DataContext.f_cardid}" />
                <!--收费类型f_payfeetype-->
                <o:PropertySetter PropertyName="f_payfeetype" Value="{m:Exp Str=userfile.DataContext.f_payfeetype}" />
                <!--气价f_gasprice-->
                <o:PropertySetter PropertyName="f_gasprice" Value="{m:Exp Str=userfile.DataContext.f_gasprice}" />
                <!--气价类型f_gaspricetype-->
                <o:PropertySetter PropertyName="f_gaspricetype" Value="{m:Exp Str=userfile.DataContext.f_gaspricetype}" />
                <!--用气性质f_gasproperties-->
                <o:PropertySetter PropertyName="f_gasproperties" Value="{m:Exp Str=userfile.DataContext.f_gasproperties}" />
                <!--用户类型f_usertype-->
                <o:PropertySetter PropertyName="f_usertype" Value="{m:Exp Str=userfile.DataContext.f_usertype}" />
                <!--网点f_sgnetwork-->
                <o:PropertySetter PropertyName="f_sgnetwork" Value="{m:Exp Str=userfile.DataContext.f_sgnetwork}" />
                <!--操作员f_sgoperator-->
                <o:PropertySetter PropertyName="f_sgoperator" Value="{m:Exp Str=userfile.DataContext.f_sgoperator}" />
                <!--分公司名称f_filiale-->
                <o:PropertySetter PropertyName="f_filiale" Value="{m:Exp Str=userfile.DataContext.f_filiale}" />
                <!--分公司编号f_fengongsinum-->
                <o:PropertySetter PropertyName="f_fengongsinum" Value="{m:Exp Str=userfile.DataContext.f_fengongsinum}" />
                <!--卡费-->
                <o:PropertySetter PropertyName="f_cardfees" Value="{m:Exp Str=userfile.DataContext.f_cardfees}" />
                <!--档案编号-->
                <o:PropertySetter PropertyName="f_userinfoid" Value="{m:Exp Str=userfile.DataContext.f_userinfoid}" />
                <!--o:PropertySetter PropertyName="f_stair1amount" NoDependValue="{m:Exp Str=userfile.DataContext.f_stair1amount}"  />
<o:PropertySetter PropertyName="f_preamount" Value="{m:Exp Str=userfile.DataContext.f_preamount}" />
 <o:PropertySetter PropertyName="f_grossproceeds" Value="{m:Exp Str=userfile.DataContext.f_grossproceeds}" />
                <o:PropertySetter PropertyName="f_totalcost" Value="{m:Exp Str=userfile.DataContext.f_totalcost}" />
                <o:PropertySetter PropertyName="f_stair1price" NoDependValue="{m:Exp Str=userfile.DataContext.f_stair1price}"  />
                <o:PropertySetter PropertyName="f_stair1fee" NoDependValue="{m:Exp Str=userfile.DataContext.f_stair1fee}"  />
                <o:PropertySetter PropertyName="f_stair2amount" NoDependValue="{m:Exp Str=userfile.DataContext.f_stair2amount}"  />
                <o:PropertySetter PropertyName="f_stair2price" NoDependValue="{m:Exp Str=userfile.DataContext.f_stair2price}"  />
                <o:PropertySetter PropertyName="f_stair2fee" NoDependValue="{m:Exp Str=userfile.DataContext.f_stair2fee}"  />
                <o:PropertySetter PropertyName="f_stair3amount" NoDependValue="{m:Exp Str=userfile.DataContext.f_stair3amount}"  />
                <o:PropertySetter PropertyName="f_stair3price" NoDependValue="{m:Exp Str=userfile.DataContext.f_stair3price}"  />
                <o:PropertySetter PropertyName="f_stair3fee" NoDependValue="{m:Exp Str=userfile.DataContext.f_stair3fee}"  /-->
                <o:PropertySetter PropertyName="f_OrdinaryNum" NoDependValue="{m:Exp Str=userfile.DataContext.f_OrdinaryNum}"  />

            </o:GeneralObject>
            <!--发卡对象-->
            <o:GeneralObject Name="userfilego" WebClientInfo="{StaticResource dbclient}" 
		EntityType="t_myfaka" 
		IsInit="{m:Exp Str='SaveAction\=\=$Error$ |or| card.State\=\=$Error$ |or| print.State==$End$'}">
                <o:PropertySetter PropertyName="f_sgnetwork" Value="{m:Exp Str=userfile.DataContext.f_sgnetwork}"/>
                <o:PropertySetter PropertyName="f_comtype" Value="天然气公司"/>

            </o:GeneralObject>

            <!--卡号对象cardid.f_qishicard-->
            <o:GeneralObject Name="cardid1" EntityType="t_cardreset" WebClientInfo="{StaticResource dbclient}"
        LoadOnPathChanged="False"    
		Path="{m:Exp Str=userfiles1.f_usertype\=\=$民用$:$sernum/from t_cardreset where id \=(select parentid from cardresetwatch where f_gaswatchbrand\=\'\{userfiles1.f_gaswatchbrand\}\' and f_fengongsi\=\'\{LoginUser.f_fengongsi\}\' and f_minyong\=\'民用\' and parentid is not null)/f_qishicard$\,userfiles1.f_usertype\=\=$非民用$:$sernum/from t_cardreset where id \=(select parentid from cardresetwatch where f_gaswatchbrand\=\'\{userfiles1.f_gaswatchbrand\}\' and f_fengongsi\=\'\{LoginUser.f_fengongsi\}\' and f_feiminyong\=\'非民用\' and parentid is not null)/f_qishicard$\,null}"
       
                             Completed="cardid1_Completed"
		>
            </o:GeneralObject>
            <!--卡对象GeneralICCard-->
            <oo:NewGeneralICCard Name="card"   
		 CanInitCard="{m:Exp Str='SaveAction.State \=\= $End$'}"
		 Gas="{m:Exp Str=userfile.DataContext.f_pregas}"
		 CardId="{m:Exp Str=userfile.DataContext.f_cardid}"
		 Factory="{m:Exp Str='userfiles1.State \=\= $Loaded$:userfiles1.f_aliasname,null'}"
		 BuyTimes="{m:Exp Str=userfilego.f_times\=\=null:0\,userfilego.f_times.ToInt()}" 
		 Klx="{m:Exp Str='userfiles1 != null\:userfiles1.klx\,0'}"		
		 Kzt="0"
		 Dqdm="{m:Exp Str='userfiles1 != null \:userfiles1.dqdm\,$001$'}"
		 Yhh="{m:Exp Str='userfiles1 != null \:userfiles1.yhh\,$1111111111$'}"
		 Tm="0001"
		 Ljgql="{m:Exp Str='userfiles1 != null \:userfiles1.f_cumulativepurchase\,0'}"
		 Bkcs="0"
		 Bjql="{m:Exp Str='userfiles1 != null \:userfiles1.bjql\,10'}"
		 Czsx="{m:Exp Str='userfiles1 != null \:userfiles1.czsx\,9999'}"
		 Tzed="{m:Exp Str='userfiles1 != null \:userfiles1.tzed\,0'}"	
		 Kmm="{m:Exp Str='userfiles1 != null \:userfiles1.kmm\,$0001$'}"
		 Sqrq="{m:Exp Str='SysTime.Now.ToString($yyyyMMdd$)'}"
		 OldPrice="{m:Exp Str='userfiles1 != null\:userfiles1.f_gasprice*100\,0'}"
		 NewPrice="{m:Exp Str='userfiles1 != null\:userfiles1.f_gasprice*100\,0'}"
		 Sxrq="{m:Exp Str='SysTime.Now.ToString($yyyyMMdd$)'}"
		 Sxbj="{m:Exp Str=card.Factory \=\= $ZhenLan$ \:null\,$1$}"
         MeterId="{m:Exp Str='userfiles1 != null \:userfiles1.f_meternumber\,$0001$'}"
         Stairprice1="{m:Exp Str='userfiles1 != null \:userfiles1.f_stair1price\,0'}"
         Stairgas1="{m:Exp Str='userfiles1 != null \:userfiles1.f_stair1amount\,0'}" 
         Stairprice2="{m:Exp Str='userfiles1 != null \:userfiles1.f_stair2price\,0'}"
         Stairgas2="{m:Exp Str='userfiles1 != null \:userfiles1.f_stair2amount\,0'}"                         
         Stairprice3="{m:Exp Str='userfiles1 != null \:userfiles1.f_stair3price\,0'}"
         Stairgas3="{m:Exp Str='userfiles1 != null \:userfiles1.f_stair3amount\,0'}" 
         Money="{m:Exp Str=userfile.DataContext.f_preamount}"      
         TotalMoney="{m:Exp Str=userfile.DataContext.f_totalcost}"                        
		>
            </oo:NewGeneralICCard>

            <!--更新发卡记录为无效-->
            <b:HQLAction Name="UpdateFaka" WebClientInfo="{StaticResource dbclient}" 
		HQL="{m:Exp Str=$update t_myfaka set f_whethergivecard\=\'无效\' where id \= \{userfilego.id\}}"/>
            <!--更新售气记录为无效-->
            <b:HQLAction Name="UpdateSellgas" WebClientInfo="{StaticResource dbclient}" 
		HQL="{m:Exp Str=$update t_sellinggas set f_payfeevalid\=\'无效\' where id \= \{sellgasobj.id\}}"/>
            <!--更新用户档案中相关信息-->
            <b:HQLAction Name="UpdateUserfile" WebClientInfo="{StaticResource dbclient}" 
		HQL="{m:Exp Str=$update t_userfiles set 
		f_whethergivecard\=\'未发\' 
		where id \= \{userfiles1.id\}}"/>
            <!--制卡失败后的自动撤销过程-->
            <b:BatchExcuteAction Name="RollbackAction" CanSave="{m:Exp Str=card.State\=\=$LoadError$}" WebClientInfo="{StaticResource dbclient}">
                <b:BatchInfo Source="{m:Exp Str=UpdateFaka}" MethodName="InvokeToJson"/>
                <b:BatchInfo Source="{m:Exp Str=UpdateUserfile}" MethodName="InvokeToJson"/>
                <b:BatchInfo Source="{m:Exp Str=UpdateSellgas}" MethodName="InvokeToJson"/>
            </b:BatchExcuteAction>

            <!--保存对象 -->
            <b:BatchExcuteAction Name="SaveAction" WebClientInfo="{StaticResource dbclient}">
                <!--售气对象-->
                <b:BatchInfo Source="{m:Exp Str=sellgasobj}" MethodName="SaveToJson"/>
                <!--用户对象-->
                <b:BatchInfo Source="{m:Exp Str=userfiles1}" MethodName="SaveToJson"/>
                <!--发卡对象-->
                <b:BatchInfo Source="{m:Exp Str=userfilego}" MethodName="SaveToJson"/>
            </b:BatchExcuteAction>
            <!--提交-->
            <b:HQLAction Name="SubmitAction" WebClientInfo="{StaticResource dbclient}" 
			HQL="{m:Exp Str=$update t_userfiles set f_substate\=null where id in (\{userfiles.SelectedItems.ToString(id)\=>SelectionChanged\}) }"/>
        </m:ResourceLoad>
        <Grid Margin="0,0,0,26" >
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="3*"/>
                <ColumnDefinition Width="7*"/>
            </Grid.ColumnDefinitions>
            <c:BusyIndicatorEx BusyContent="正在查询，请稍等" IsBusy="{m:Exp Str=userfiles.ItemsSource.IsBusy}" >
                <toolkit:DockPanel>
                    <toolkit:DockPanel Height="67"  Background="{x:Null}" toolkit:DockPanel.Dock="Bottom" >
                        <TextBlock Height="33" toolkit:DockPanel.Dock="Bottom" Text="{m:Exp Str='$共{userfiles.ItemsSource.Count}项'}" Margin="0,3,0,0" Width="Auto" HorizontalAlignment="Stretch" Foreground="#FF140000" VerticalAlignment="Stretch"/>
                        <sdk:DataPager x:Name="pager" Source="{Binding Path=ItemsSource.Count,ElementName=userfiles,Converter={StaticResource DataPagerConverter}}"    Margin="0" PageSize="20" Height="24"/>
                    </toolkit:DockPanel>
                    <Grid x:Name="userfilesearch" toolkit:DockPanel.Dock="Top" Background="#FFCFEFFF" Margin="0,0,0,1" >
                        <Grid.RowDefinitions>
                            <RowDefinition Height="27"/>
                            <RowDefinition Height="27"/>
                            <RowDefinition Height="27"/>
                            <RowDefinition Height="27"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="100"/>
                            <ColumnDefinition Width="50*"/>
                            <ColumnDefinition Width="50*"/>
                        </Grid.ColumnDefinitions>
                        <a:Data.Context>
                            <o:SearchObject></o:SearchObject>
                        </a:Data.Context>

                        <TextBlock TextWrapping="Wrap" Text="客户编号：" Margin="5,0,0,0" TextAlignment="Right"/>
                        <TextBox TextWrapping="Wrap" Grid.Column="1" Text="{m:Bind Path=f_userid}" a:ControlAttach.DefaultButton="searchbutton" Width="Auto" Grid.Row="3">
                            <a:Data.Prop>
                                <o:PropertySetter PropertyName="f_userid" Operator="f_userid like 'this%'"/>
                            </a:Data.Prop>
                        </TextBox>
                        <TextBlock TextWrapping="Wrap" Grid.Row="1" Text="姓　　名：" Margin="3,0,0,0" TextAlignment="Right"/>
                        <TextBox TextWrapping="Wrap" Grid.Column="1" Grid.Row="1" Text="{m:Bind Path=f_username}" a:ControlAttach.DefaultButton="searchbutton" Width="Auto" Margin="0,1" >
                            <a:Data.Prop>
                                <o:PropertySetter PropertyName="f_username" Operator="f_username like 'this%'"/>
                            </a:Data.Prop>
                        </TextBox>
                        <TextBlock TextWrapping="Wrap" Grid.Row="2" Text="小　　区：" Margin="3,0,0,0" TextAlignment="Right"/>
                        <TextBox TextWrapping="Wrap" Grid.Column="1" Grid.Row="2" Text="{m:Bind Path=f_districtname}" a:ControlAttach.DefaultButton="searchbutton" Width="Auto" Margin="0,1" >
                            <a:Data.Prop>
                                <o:PropertySetter PropertyName="f_districtname" Operator="f_districtname like 'this%'"/>
                            </a:Data.Prop>
                        </TextBox>
                        <TextBlock TextWrapping="Wrap" Grid.Row="3" Text="新系统编号：" Margin="3,0,0,0" TextAlignment="Right"/>
                        <TextBox TextWrapping="Wrap" Grid.Column="1" Grid.Row="0" Text="{m:Bind Path=f_userinfoid}" a:ControlAttach.DefaultButton="searchbutton" Width="Auto" Margin="0,1" >
                            <a:Data.Prop>
                                <o:PropertySetter PropertyName="f_userinfoid" Operator="f_userinfoid = 'this'"/>
                            </a:Data.Prop>
                        </TextBox>
                        <Button Content="查  询" x:Name="searchbutton" Grid.Column="2" Grid.Row="3" Click="{m:Exp Str=userfilesearch.DataContext.Search()}" Margin="0,-3,5,0" HorizontalAlignment="Right" Width="50"/>
                    </Grid>
                    <sdk:DataGrid x:Name="userfiles"  
                	SelectedItem="{m:Exp Str=card.State\=\=$Error$:null\,this.SelectedItem}"
					AutoGenerateColumns="False" Width="Auto" Background="{x:Null}" IsReadOnly="True" Margin="0,1,0,0" >
                        <a:Data.Items>
                            <o:PagedObjectList x:Name="userfileslist" WebClientInfo="{StaticResource dbclient}" 
							MultiPath="{m:Exp Str=$from t_userfiles where \{userfilesearch.DataContext.Condition\} and f_whethergivecard \=\'未发\' and f_gasmeterstyle \=\'卡表\' and f_gasmeterstyle \=\'卡表\' and  (f_OrgStr  like  \'\{$%$\}\{LoginUser.f_parentname\}\{$%$\}\')}"
                			Path="{m:Exp Str=$from t_userfiles where \{userfilesearch.DataContext.Condition\} and f_whethergivecard \=\'未发\' and f_gasmeterstyle \=\'卡表\'  and f_gasmeterstyle \=\'卡表\' and  (f_OrgStr  like  \'\{$%$\}\{LoginUser.f_parentname\}\{$%$\}\') order by id }"
                			IsOld="{m:Exp Str='print.State\=\=$End$'}"
							PageIndex="{m:Exp Str=pager.PageIndex}" PageSize="{m:Exp Str=pager.PageSize}" SumNames="f_times"/>
                        </a:Data.Items>
                        <sdk:DataGrid.Columns>
                            <sdk:DataGridTextColumn d:IsLocked="True" Header="序  号" Binding="{Binding Index}"/>
                            <sdk:DataGridTextColumn d:IsLocked="True" Header="用户编号" Binding="{Binding f_userid}"/>
                            <sdk:DataGridTextColumn d:IsLocked="True" Header="用户类型" Binding="{Binding f_usertype}"/>
                            <sdk:DataGridTextColumn d:IsLocked="True" Header="姓  名" Binding="{Binding f_username}"/>
                            <sdk:DataGridTextColumn d:IsLocked="True" Header="气表品牌" Binding="{Binding f_gaswatchbrand}"/>
                            <sdk:DataGridTextColumn d:IsLocked="True" Header="气表型号" Binding="{Binding f_metertype}"/>

                            <sdk:DataGridTextColumn d:IsLocked="True" Header="小区名称" Binding="{Binding f_districtname}"/>
                            <sdk:DataGridTextColumn d:IsLocked="True" Header="门牌号" Binding="{Binding f_apartment}"/>
                        </sdk:DataGrid.Columns>
                    </sdk:DataGrid>
                </toolkit:DockPanel>
            </c:BusyIndicatorEx>
            <c:BusyIndicatorEx x:Name="ui_chargeBusy"
		BusyContent="{m:Exp Str=SaveAction.IsBusy:$正在访问服务器，请稍等...$\,card.IsBusy:$正在操作卡，请稍等...$\,$正在工作，请稍等...$}" 
		IsBusy="{m:Exp Str=card.IsBusy or userfiles.DataContext.IsBusy or SaveAction.IsBusy}" Margin="10,0,0,0" Grid.Column="1" >
                <Grid Background="{x:Null}" x:Name="userfile" DataContext="{m:Exp Str=userfilego}" >
                    <toolkit:DockPanel>
                        <!--按钮-->
                        <toolkit:DockPanel toolkit:DockPanel.Dock="Bottom"  >
                            <StackPanel Orientation="Horizontal" Width="170">
                                <Button x:Name="save" Content="写  卡" Margin="5" IsEnabled="{m:Exp Str=!sellgasobj.HasErrors and userfile.DataContext.f_preamount!\=null}"
						Click="{m:Exp Str=userfiles1.f_beginfee\=userfilego.f_beginfee;userfilego.f_times \= userfilego.f_times+1;userfiles1.f_times\=userfilego.f_times.ToInt();sellgasobj.f_times\=userfilego.f_times.ToInt();sellgasobj.f_deliverydate\=userfilego.f_deliverydate;sellgasobj.f_deliverytime\=userfilego.f_deliverytime;sellgasobj.f_metergasnums\=userfilego.f_metergasnums;sellgasobj.f_cumulativepurchase\=userfilego.f_cumulativepurchase;userfiles1.f_metergasnums\=userfilego.f_metergasnums;userfiles1.f_cumulativepurchase\=userfilego.f_cumulativepurchase;userfiles1.f_finabuygasdate\=userfilego.f_deliverydate;userfiles1.f_dateofopening\=userfilego.f_givecarddate;userfiles1.f_givecarddate\=userfilego.f_givecarddate;sellgasobj.f_payfeevalid\=$有效$;sellgasobj.f_comtype\=$天然气公司$;sellgasobj.f_payfeetype\=userfilego.f_payfeetype;userfiles1.f_whethergivecard\=$已发$;userfiles1.f_whethergivepassbook\=$已发$;sellgasobj.f_payment\=userfilego.f_payment;sellgasobj.f_sgoperator\=userfilego.f_sgoperator;sellgasobj.f_sgnetwork\=userfilego.f_sgnetwork;sellgasobj.f_filiale\=userfilego.f_filiale;userfiles1.f_watchinstalldate\=userfilego.f_watchinstalldate;card.Sqrq\=userfilego.f_deliverydate.ToString($yyyyMMdd$);cardid1.Load()}" Width="50" />
                                <Button Content="撤  销" Margin="5" Click="{m:Exp Str=userfile.DataContext.New()}" Width="50">
                                </Button>
                            </StackPanel>
                            <StackPanel  Orientation="Horizontal" HorizontalAlignment="Right">
                            </StackPanel>
                        </toolkit:DockPanel>
                        <Grid  toolkit:DockPanel.Dock="Top" Margin="0" Height="Auto">
                            <Grid.Background>
                                <LinearGradientBrush EndPoint="0.5,1" MappingMode="RelativeToBoundingBox" StartPoint="0.5,0">
                                    <GradientStop Color="#FFF2F8FF" Offset="0"/>
                                    <GradientStop Color="#FFDDF2FD" Offset="1"/>
                                </LinearGradientBrush>
                            </Grid.Background>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="30"/>
                                <RowDefinition Height="30"/>
                                <RowDefinition Height="30"/>
                                <RowDefinition Height="30"/>
                                <RowDefinition Height="30"/>
                                <RowDefinition Height="30"/>
                                <RowDefinition Height="30"/>
                                <RowDefinition Height="30"/>
                                <RowDefinition Height="30"/>
                                <RowDefinition Height="30"/>
                                <RowDefinition Height="30"/>
                                <RowDefinition Height="30"/>
                                <RowDefinition Height="30"/>
                                <RowDefinition Height="30"/>
                                <RowDefinition Height="30"/>
                                <RowDefinition Height="30"/>
                                <RowDefinition Height="2"/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="130"/>
                                <ColumnDefinition Width="0.323*"/>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="0.346*"/>
                                <ColumnDefinition Width="145"/>
                                <ColumnDefinition Width="0.331*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="用户编号：" Margin="0,6,0,0" TextWrapping="Wrap" TextAlignment="Right" Height="25"/>
                            <TextBlock Text="姓      名：" Grid.Column="2" Margin="0,6,0,0" TextWrapping="Wrap" TextAlignment="Right" Height="25"/>
                            <TextBlock Text="小区地址：" Grid.Column="4" Margin="0,6,0,0" TextWrapping="Wrap" TextAlignment="Right" Height="25"/>
                            <TextBlock Text="小区名称：" Margin="0,6,0,0" Grid.Row="1" TextWrapping="Wrap" TextAlignment="Right" Height="25"/>
                            <TextBlock Text="气表品牌：" Grid.Column="2" Margin="0,6,0,0" Grid.Row="1" TextWrapping="Wrap" TextAlignment="Right" Height="25"/>
                            <TextBlock Text="气表型号：" Grid.Column="4" Margin="0,6,0,0" Grid.Row="1" TextWrapping="Wrap" TextAlignment="Right" Height="25"/>
                            <TextBlock Text="气表厂家：" Margin="0" Grid.Row="2" TextWrapping="Wrap" TextAlignment="Right" Height="25"/>
                            <TextBlock Text="用户类型：" Grid.Column="2" Margin="0" Grid.Row="2" TextWrapping="Wrap" TextAlignment="Right" Height="25"/>
                            <TextBlock Text="用气性质：" Grid.Column="4" Margin="0" Grid.Row="2" TextWrapping="Wrap" TextAlignment="Right" Height="25"/>
                            <TextBlock Text="增补材料费：" Margin="0,6,0,0" TextWrapping="Wrap" TextAlignment="Right" Grid.Row="4" Height="25"/>
                            <TextBlock Text="卡      号：" Grid.Column="2" Margin="0,6,0,0" TextWrapping="Wrap" TextAlignment="Right" Grid.Row="4" Height="25"/>
                            <TextBlock Text="发卡日期：" Grid.Column="4" Margin="0,6,0,0" TextWrapping="Wrap" TextAlignment="Right" Grid.Row="4" Height="25"/>
                            <TextBlock Text="卡      费：" Margin="0,6,0,-1" TextWrapping="Wrap" TextAlignment="Right" Grid.Row="5" Height="25" HorizontalAlignment="Left" Width="130"/>
                            <TextBlock Text="部      门：" Grid.Column="2" Margin="0,6,0,0" TextWrapping="Wrap" TextAlignment="Right" Grid.Row="5" Height="25"/>
                            <TextBlock Text="操  作 人：" Grid.Column="4" Margin="0,6,0,0" TextWrapping="Wrap" TextAlignment="Right" Grid.Row="5" Height="25"/>
                            <TextBlock Text="预购气量：" Margin="0" TextWrapping="Wrap" TextAlignment="Right" Grid.Row="10" Grid.Column="4" Height="25"/>
                            <TextBlock Text="预购金额：" Grid.Column="2" Margin="0,6,0,0" TextWrapping="Wrap" TextAlignment="Right" Grid.Row="6" Height="25"/>
                            <TextBlock Text="阶梯气价类型：" Grid.Column="4"  TextWrapping="Wrap" TextAlignment="Right" Grid.Row="6" Margin="0" Height="25"/>
                            <TextBox Text="{m:Bind Path=f_stairtype}" Grid.Column="5"  Grid.Row="6" TextWrapping="Wrap" IsReadOnly="True" HorizontalAlignment="Stretch" Width="Auto" Margin="0,0" Grid.ColumnSpan="1" Height="25" VerticalAlignment="Stretch" >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_stairtype" Value="{m:Exp Str=userfiles1.f_stairtype}"/>
                                </a:Data.Prop>
                            </TextBox>


                            <Button HorizontalAlignment="Left" Click="DisplayPopup" Grid.Row="5" 
                                      Width="60" Margin="0,21,0,10" Grid.RowSpan="2">
                                <StackPanel>
                                    <TextBlock>查看阶梯</TextBlock>
                                    <Popup Name="myPopup">

                                        <Grid Width="750">
                                            <Grid.Background>
                                                <LinearGradientBrush EndPoint="0.5,1" MappingMode="RelativeToBoundingBox" StartPoint="0.5,0">
                                                    <GradientStop Color="#FFF2F8FF" Offset="0"/>
                                                    <GradientStop Color="#FFDDF2FD" Offset="1"/>
                                                </LinearGradientBrush>
                                            </Grid.Background>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="30"/>
                                                <RowDefinition Height="30"/>
                                                <RowDefinition Height="30"/>
                                                <RowDefinition Height="30"/>
                                                <RowDefinition Height="30"/>
                                                <RowDefinition Height="30"/>

                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="140"/>
                                                <ColumnDefinition Width="1*"/>
                                                <ColumnDefinition Width="140"/>
                                                <ColumnDefinition Width="1*"/>
                                                <ColumnDefinition Width="140"/>
                                                <ColumnDefinition Width="1*"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Text="阶梯一气量：" Grid.Column="0"  TextWrapping="Wrap" TextAlignment="Right" Grid.Row="0" Margin="0" Height="25"/>
                                            <TextBlock Text="阶梯二气量：" Grid.Column="0"  TextWrapping="Wrap" TextAlignment="Right" Grid.Row="1" Margin="0" Height="25"/>
                                            <TextBlock Text="阶梯三气量：" Grid.Column="0"  TextWrapping="Wrap" TextAlignment="Right" Grid.Row="2" Margin="0" Height="25"/>
                                            <TextBlock Text="阶梯一单价：" Grid.Column="2"  TextWrapping="Wrap" TextAlignment="Right" Grid.Row="0" Margin="0" Height="25"/>
                                            <TextBlock Text="阶梯二单价：" Grid.Column="2"  TextWrapping="Wrap" TextAlignment="Right" Grid.Row="1" Margin="0" Height="25"/>
                                            <TextBlock Text="阶梯三单价：" Grid.Column="2"  TextWrapping="Wrap" TextAlignment="Right" Grid.Row="2" Margin="0" Height="25"/>
                                            <TextBlock Text="阶梯一金额：" Grid.Column="4"  TextWrapping="Wrap" TextAlignment="Right" Grid.Row="0" Margin="0" Height="25"/>
                                            <TextBlock Text="阶梯二金额：" Grid.Column="4"  TextWrapping="Wrap" TextAlignment="Right" Grid.Row="1" Margin="0" Height="25"/>
                                            <TextBlock Text="阶梯三金额：" Grid.Column="4"  TextWrapping="Wrap" TextAlignment="Right" Grid.Row="2" Margin="0" Height="25"/>
                                            <TextBlock Text="超过阶梯三气量：" Grid.Column="0"  TextWrapping="Wrap" TextAlignment="Right" Grid.Row="3" Margin="0" Height="25"/>
                                            <TextBlock Text="超过阶梯三单价：" Grid.Column="2"  TextWrapping="Wrap" TextAlignment="Right" Grid.Row="3" Margin="0" Height="25"/>
                                            <TextBlock Text="超过阶梯三金额：" Grid.Column="4"  TextWrapping="Wrap" TextAlignment="Right" Grid.Row="3" Margin="0" Height="25"/>
                                            <TextBlock Text="当前阶段开始日期：" Grid.Column="0"  TextWrapping="Wrap" TextAlignment="Right" Grid.Row="4" Margin="0" Height="25"/>
                                            <TextBlock Text="当前阶段结束日期：" Grid.Column="2"  TextWrapping="Wrap" TextAlignment="Right" Grid.Row="4" Margin="0" Height="25"/>
                                            <TextBlock Text="当前阶段累计购气量：" Grid.Column="4"  TextWrapping="Wrap" TextAlignment="Right" Grid.Row="4" Margin="0" Height="25"/>
                                            <TextBox x:Name="ui_stair1amont" Text="{m:Bind Path=f_stair1amount}" Grid.Column="1"  Grid.Row="0" TextWrapping="Wrap" IsReadOnly="True" HorizontalAlignment="Stretch" Width="Auto" Margin="0,0" Grid.ColumnSpan="1" Height="25" VerticalAlignment="Stretch" >
                                                <a:Data.Prop>
                                                    <o:PropertySetter PropertyName="f_stair1amount"/>
                                                </a:Data.Prop>
                                            </TextBox>
                                            <TextBox x:Name="ui_stair2amont" Text="{m:Bind Path=f_stair2amount}" Grid.Column="1"  Grid.Row="1" TextWrapping="Wrap" IsReadOnly="True" HorizontalAlignment="Stretch" Width="Auto" Margin="0,0" Grid.ColumnSpan="1" Height="25" VerticalAlignment="Stretch" >
                                                <a:Data.Prop>
                                                    <o:PropertySetter PropertyName="f_stair2amount" />
                                                </a:Data.Prop>
                                            </TextBox>
                                            <TextBox  x:Name="ui_stair3amont" Text="{m:Bind Path=f_stair3amount}" Grid.Column="1"  Grid.Row="2" TextWrapping="Wrap" IsReadOnly="True" HorizontalAlignment="Stretch" Width="Auto" Margin="0,0" Grid.ColumnSpan="1" Height="25" VerticalAlignment="Stretch" >
                                                <a:Data.Prop>
                                                    <o:PropertySetter PropertyName="f_stair3amount" />
                                                </a:Data.Prop>
                                            </TextBox>
                                            <TextBox x:Name="ui_stair1price" Text="{m:Bind Path=f_stair1price}" Grid.Column="3"  Grid.Row="0" TextWrapping="Wrap" IsReadOnly="True" HorizontalAlignment="Stretch" Width="Auto" Margin="0,0" Grid.ColumnSpan="1" Height="25" VerticalAlignment="Stretch" >
                                                <a:Data.Prop>
                                                    <o:PropertySetter PropertyName="f_stair1price" />
                                                </a:Data.Prop>
                                            </TextBox>
                                            <TextBox x:Name="ui_stair2price" Text="{m:Bind Path=f_stair2price}" Grid.Column="3"  Grid.Row="1" TextWrapping="Wrap" IsReadOnly="True" HorizontalAlignment="Stretch" Width="Auto" Margin="0,0" Grid.ColumnSpan="1" Height="25" VerticalAlignment="Stretch" >
                                                <a:Data.Prop>
                                                    <o:PropertySetter PropertyName="f_stair2price" />
                                                </a:Data.Prop>
                                            </TextBox>
                                            <TextBox x:Name="ui_stair3price" Text="{m:Bind Path=f_stair3price}" Grid.Column="3"  Grid.Row="2" TextWrapping="Wrap" IsReadOnly="True" HorizontalAlignment="Stretch" Width="Auto" Margin="0,0" Grid.ColumnSpan="1" Height="25" VerticalAlignment="Stretch" >
                                                <a:Data.Prop>
                                                    <o:PropertySetter PropertyName="f_stair3price" />
                                                </a:Data.Prop>
                                            </TextBox>
                                            <TextBox x:Name="ui_stair4amont" Text="{m:Bind Path=f_stair4amont}" Grid.Column="1"  Grid.Row="3" TextWrapping="Wrap" IsReadOnly="True" HorizontalAlignment="Stretch" Width="Auto" Margin="0,0" Grid.ColumnSpan="1" Height="25" VerticalAlignment="Stretch" >
                                                <a:Data.Prop>
                                                    <o:PropertySetter PropertyName="f_stair4amount" />
                                                </a:Data.Prop>
                                            </TextBox>
                                            <TextBox x:Name="ui_stair4price" Text="{m:Bind Path=f_stair4price}" Grid.Column="3"  Grid.Row="3" TextWrapping="Wrap" IsReadOnly="True" HorizontalAlignment="Stretch" Width="Auto" Margin="0,0" Grid.ColumnSpan="1" Height="25" VerticalAlignment="Stretch" >
                                                <a:Data.Prop>
                                                    <o:PropertySetter PropertyName="f_stair4price" />
                                                </a:Data.Prop>
                                            </TextBox>
                                            <TextBox x:Name="ui_stair4fee" Text="{m:Bind Path=f_stair4fee}" Grid.Column="5"  Grid.Row="3" TextWrapping="Wrap" IsReadOnly="True" HorizontalAlignment="Stretch" Width="Auto" Margin="0,0" Grid.ColumnSpan="1" Height="25" VerticalAlignment="Stretch" >
                                                <a:Data.Prop>
                                                    <o:PropertySetter PropertyName="f_stair4fee" />
                                                </a:Data.Prop>
                                            </TextBox>
                                            <TextBox x:Name="ui_stardate" Text="{m:Bind Path=f_stardate}" Grid.Column="1"  Grid.Row="4" TextWrapping="Wrap" IsReadOnly="True" HorizontalAlignment="Stretch" Width="Auto" Margin="0,0" Grid.ColumnSpan="1" Height="25" VerticalAlignment="Stretch" >
                                                <a:Data.Prop>
                                                    <o:PropertySetter PropertyName="f_stardate" />
                                                </a:Data.Prop>
                                            </TextBox>
                                            <TextBox x:Name="ui_enddate" Text="{m:Bind Path=f_enddate}" Grid.Column="3"  Grid.Row="4" TextWrapping="Wrap" IsReadOnly="True" HorizontalAlignment="Stretch" Width="Auto" Margin="0,0" Grid.ColumnSpan="1" Height="25" VerticalAlignment="Stretch" >
                                                <a:Data.Prop>
                                                    <o:PropertySetter PropertyName="f_enddate" />
                                                </a:Data.Prop>
                                            </TextBox>
                                            <TextBox x:Name="ui_allamont" Text="{m:Bind Path=f_allamont}" Grid.Column="5"  Grid.Row="4" TextWrapping="Wrap" IsReadOnly="True" HorizontalAlignment="Stretch" Width="Auto" Margin="0,0" Grid.ColumnSpan="1" Height="25" VerticalAlignment="Stretch" >
                                                <a:Data.Prop>
                                                    <o:PropertySetter PropertyName="f_allamont" />
                                                </a:Data.Prop>
                                            </TextBox>
                                            <TextBox  x:Name="ui_stair1fee" Text="{m:Bind Path=f_stair1fee}" Grid.Column="5"  Grid.Row="0" TextWrapping="Wrap" IsReadOnly="True" HorizontalAlignment="Stretch" Width="Auto" Margin="0,0" Grid.ColumnSpan="1" Height="25" VerticalAlignment="Stretch" >
                                                <a:Data.Prop>
                                                    <o:PropertySetter PropertyName="f_stair1fee" />
                                                </a:Data.Prop>
                                            </TextBox>
                                            <TextBox x:Name="ui_stair2fee" Text="{m:Bind Path=f_stair2fee}" Grid.Column="5"  Grid.Row="1" TextWrapping="Wrap" IsReadOnly="True" HorizontalAlignment="Stretch" Width="Auto" Margin="0,0" Grid.ColumnSpan="1" Height="25" VerticalAlignment="Stretch" >
                                                <a:Data.Prop>
                                                    <o:PropertySetter PropertyName="f_stair2fee" />
                                                </a:Data.Prop>
                                            </TextBox>
                                            <TextBox x:Name="ui_stair3fee" Text="{m:Bind Path=f_stair3fee}" Grid.Column="5"  Grid.Row="2" TextWrapping="Wrap" IsReadOnly="True" HorizontalAlignment="Stretch" Width="Auto" Margin="0,0" Grid.ColumnSpan="1" Height="25" VerticalAlignment="Stretch" >
                                                <a:Data.Prop>
                                                    <o:PropertySetter PropertyName="f_stair3fee" />
                                                </a:Data.Prop>
                                            </TextBox>
                                        </Grid>

                                    </Popup>
                                </StackPanel>
                            </Button>

                            <TextBlock Text="气      价：" Margin="0,6,0,0" TextWrapping="Wrap" TextAlignment="Right" Grid.Row="6" Height="25"/>
                            <TextBlock Text="购气日期：" Grid.Column="2" Margin="0" TextWrapping="Wrap" TextAlignment="Right" Grid.Row="12" Height="25"/>
                            <TextBlock Text="是否发卡：" Margin="0,6,0,0" TextWrapping="Wrap" TextAlignment="Right" Grid.Column="4" Grid.Row="12" Height="25"/>
                            <TextBlock Text="本次总累计购气量：" Margin="0,6,0,0" TextWrapping="Wrap" TextAlignment="Right" Grid.Row="9" Height="25"/>
                            <TextBlock Text="上次总累计购气量：" Margin="0,6,0,0" TextWrapping="Wrap" TextAlignment="Right" Grid.Row="8" Grid.Column="2" Height="25"/>
                            <TextBlock Text="当前表累计购气量：" Grid.Column="2" Margin="0,6,0,0" TextWrapping="Wrap" TextAlignment="Right" Grid.Row="9" Height="25"/>
                            <TextBlock Text="当前表上次累计购气量：" Margin="0,6,0,0" TextWrapping="Wrap" TextAlignment="Right" Grid.Row="8" Grid.Column="4" Height="25"/>
                            <TextBlock Text="限购气量：" Margin="0,6,0,0" TextWrapping="Wrap" TextAlignment="Right" Grid.Row="10" Height="25"/>
                            <TextBlock Text="收　　款：" Margin="0" TextWrapping="Wrap" TextAlignment="Right" Grid.Row="12" Height="25"/>
                            <TextBlock Text="应交金额：" Grid.Column="2" Margin="0" TextWrapping="Wrap" TextAlignment="Right" Grid.Row="11" Height="25"/>
                            <TextBlock Text="表　　号：" Grid.Column="4" Margin="0,6,0,0" TextWrapping="Wrap" TextAlignment="Right" Grid.Row="3" Height="25"/>
                            <TextBlock Text="本次结余：" Margin="0" TextWrapping="Wrap" TextAlignment="Right" Grid.Row="11" Grid.Column="4" Height="25"/>
                            <TextBlock Text="操  作  员：" Margin="0" TextWrapping="Wrap" TextAlignment="Right" Grid.Row="13" Height="25"/>
                            <Border  Grid.Row="16" Margin="8,-1,-3,0" BorderThickness="0,0,0,3" Grid.ColumnSpan="6" Height="12" VerticalAlignment="Top" >
                                <Border.Background>
                                    <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                        <GradientStop Color="#FFC6E2FB" Offset="1"/>
                                        <GradientStop Color="#FFE6F1FB"/>
                                    </LinearGradientBrush>
                                </Border.Background>
                            </Border>
                            <TextBox  x:Name="f_userid"    Text="{m:Bind Path=f_userid}"  Grid.Column="1" Margin="0" TextWrapping="Wrap" Grid.ColumnSpan="1" Height="25" IsReadOnly="True" >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_userid" Value="{m:Exp Str=userfiles1.f_userid}"/>
                                </a:Data.Prop>
                            </TextBox>
                            <TextBox Text="{m:Bind Path=f_username}" Grid.Column="3" Margin="0" Grid.Row="0" TextWrapping="Wrap" IsReadOnly="True" Height="25" >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_username" Value="{m:Exp Str=userfiles1.f_username}" />
                                </a:Data.Prop>
                            </TextBox>

                            <TextBox Text="{m:Bind Path=f_address}"  Grid.Column="5" Margin="0" Grid.Row="0" TextWrapping="Wrap" IsReadOnly="True" Height="25" VerticalAlignment="Stretch" >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_address" Value="{m:Exp Str=userfiles1.f_address}" />
                                </a:Data.Prop>
                            </TextBox>

                            <TextBox Text="{m:Bind Path=f_districtname}"  Grid.Column="1" Margin="0" Grid.Row="1" TextWrapping="Wrap" IsReadOnly="True" Height="25" >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_districtname" Value="{m:Exp Str=userfiles1.f_districtname}"/>
                                </a:Data.Prop>
                            </TextBox>
                            <TextBox Text="{m:Bind Path=f_gaswatchbrand}"  Grid.Column="3" Margin="0" Grid.Row="1" TextWrapping="Wrap" Height="25" IsReadOnly="True">
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_gaswatchbrand" Value="{m:Exp Str=userfiles1.f_gaswatchbrand}" />
                                </a:Data.Prop>
                            </TextBox>
                            <TextBox Name="qbnumber" Text="{m:Bind Path=f_metertype}" Grid.Column="5" Margin="0" Grid.Row="1" TextWrapping="Wrap" Height="25" IsReadOnly="True" VerticalAlignment="Stretch">
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_metertype" Value="{m:Exp Str=userfiles1.f_metertype}" />
                                </a:Data.Prop>
                            </TextBox>
                            <TextBox Text="{m:Bind Path=f_gasmetermanufacturers}"  Grid.Column="1" Margin="0" Grid.Row="2" TextWrapping="Wrap" IsReadOnly="True" Height="25" >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_gasmetermanufacturers" Value="{m:Exp Str=userfiles1.f_gasmetermanufacturers}"/>
                                </a:Data.Prop>
                            </TextBox>
                            <TextBox Text="{m:Bind Path=f_usertype}" x:Name="f_usertype" Grid.Column="3" Margin="0" Grid.Row="2" IsReadOnly="True" Height="25" >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_usertype" Value="{m:Exp Str=userfiles1.f_usertype}" />
                                </a:Data.Prop>
                            </TextBox>
                            <TextBox Text="{m:Bind Path=f_gasproperties}" Grid.Column="5" Margin="0" Grid.Row="2" TextWrapping="Wrap" IsReadOnly="True" Height="25" VerticalAlignment="Stretch">
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_gasproperties" Value="{m:Exp Str=userfiles1.f_gasproperties}" />
                                </a:Data.Prop>
                            </TextBox>
                            <TextBox Text="{m:Bind Path=f_bigsmallcard}"  Grid.Column="1" Margin="0,3,0,2" TextWrapping="Wrap" Grid.ColumnSpan="1" IsReadOnly="True" Grid.Row="4" Height="25" HorizontalAlignment="Left" Width="0"  >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_bigsmallcard" Value="{m:Exp Str=userfiles1.f_bigsmallcard}" />
                                </a:Data.Prop>
                            </TextBox>
                            <TextBox Text="{m:Bind Path=f_cardid}" Grid.Column="3" Margin="0" Grid.Row="4" TextWrapping="Wrap" IsReadOnly="True" Height="25" >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_cardid"    Value="{m:Exp Str='cardid1.State \=\= $Loaded$:cardid1.f_qishicard,null'}" />
                                </a:Data.Prop>
                            </TextBox>
                            <sdk:DatePicker SelectedDate="{m:Bind Path=f_givecarddate}" IsEnabled="False"  Grid.Column="5" Margin="0" Grid.Row="4" Height="25" VerticalAlignment="Stretch" >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_givecarddate" 
									Default="{m:Exp Str=SysTime.Today}"/>
                                </a:Data.Prop>
                            </sdk:DatePicker>
                            <TextBox Text="{m:Bind Path=f_cardfees}" x:Name="f_cardfees"  Grid.Column="1" Margin="0" TextWrapping="Wrap" Grid.ColumnSpan="1" IsReadOnly="True" Grid.Row="5" Height="25"  >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_cardfees"  Value="{m:Exp Str='openkafei.Result\!\=null:openkafei.Result\,fakafei.value'}"/>
                                </a:Data.Prop>
                            </TextBox>
                            <Button Content="修改" Width="34" Grid.Row="5" Grid.Column="2" 
							Click="{m:Exp Str='openkafei.IsOpen=True'}" HorizontalAlignment="Left"/>
                            <TextBox Text="{m:Bind Path=f_departments}" Grid.Column="3" Margin="0" Grid.Row="5" TextWrapping="Wrap" IsReadOnly="True" Height="25" >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_departments" 
									Default="{m:Exp Str=LoginUser.f_parentname}"/>
                                </a:Data.Prop>
                            </TextBox>
                            <TextBox Text="{m:Bind Path=f_operator}"  Grid.Column="5" Margin="0" Grid.Row="5" TextWrapping="Wrap" IsReadOnly="True" Height="25" VerticalAlignment="Stretch" >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_operator" 
									Default="{m:Exp Str=LoginUser.name}"/>
                                </a:Data.Prop>
                            </TextBox>
                            <TextBox  x:Name="ui_pregas"  LostFocus="ui_pregas_LostFocus" Text="{m:Bind Path=f_pregas}" FontWeight="Bold" Foreground="Red" Grid.Column="5" Margin="0" Grid.Row="10" TextWrapping="Wrap" Height="25" VerticalAlignment="Stretch" >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_pregas" Value="{m:Exp Str='userfilego.f_usertype\=\=$民用$:userfiles1.f_kaihuql,null'}" NotNull="True"/>
                                </a:Data.Prop>
                            </TextBox>

                            <TextBox Text="{m:Bind Path=f_gasprice}" Grid.Column="1" Margin="0" Grid.Row="6" TextWrapping="Wrap" IsReadOnly="True" HorizontalAlignment="Stretch" Height="25"  >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_gasprice"  Value="{m:Exp Str=userfiles1.f_gasprice}"/>
                                </a:Data.Prop>
                            </TextBox>
                            <sdk:DatePicker SelectedDate="{m:Bind Path=f_deliverydate}" IsEnabled="False"  Grid.Column="3" Margin="0" Grid.Row="12"  Height="25" VerticalAlignment="Stretch"  >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_deliverydate" 
									Default="{m:Exp Str=SecRefresh\=&gt;TimeEvent!\=null:SysTime.Now\,$$}"/>
                                </a:Data.Prop>
                            </sdk:DatePicker>
                            <TextBox  x:Name="ui_preamount"   Text="{m:Bind Path=f_preamount}"  Grid.Column="3" Margin="0" TextWrapping="Wrap" Grid.ColumnSpan="1" IsReadOnly="True" Grid.Row="6" Height="25"  >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_preamount" 
								 />
                                </a:Data.Prop>
                            </TextBox>
                            <TextBox Text="{m:Bind Path=f_whethergivecard}"  Grid.Column="5" Margin="0" TextWrapping="Wrap" Grid.ColumnSpan="1" IsReadOnly="True" Grid.Row="12" Height="25" VerticalAlignment="Stretch"  >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_whethergivecard" Default="已发" />
                                </a:Data.Prop>
                            </TextBox>
                            <TextBox Text="{m:Bind Path=f_upbuynum}" Grid.Column="3" Margin="0" Grid.Row="8" TextWrapping="Wrap" IsReadOnly="True" Height="25" >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_upbuynum" 
									Value="{m:Exp Str=userfiles1.f_zongleiji}" Default="0"/>
                                </a:Data.Prop>
                            </TextBox>
                            <TextBox Text="{m:Bind Path=f_metergasnums}"  Grid.Column="3" Margin="0" Grid.Row="9" TextWrapping="Wrap" IsReadOnly="True" Height="25" >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_metergasnums" Default="0"
									Value="{m:Exp Str=userfilego.f_premetergasnums+userfilego.f_pregas}"/>
                                </a:Data.Prop>
                            </TextBox>
                            <TextBox Text="{m:Bind Path=f_cumulativepurchase}"  Grid.Column="1" Margin="0" TextWrapping="Wrap" Grid.ColumnSpan="1" IsReadOnly="True" Grid.Row="9" Height="25"  >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_cumulativepurchase" Default="0"
									Value="{m:Exp Str=userfilego.f_upbuynum+userfilego.f_pregas}"/>
                                </a:Data.Prop>
                            </TextBox>

                            <TextBox Text="{m:Bind Path=f_premetergasnums}"  Grid.Column="5" Margin="0" TextWrapping="Wrap"  IsReadOnly="True" Grid.Row="8" Height="25" VerticalAlignment="Stretch"  >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_premetergasnums" Default="0"
									Value="{m:Exp Str=userfiles1.f_biaoleiji\=>Completed}"/>
                                </a:Data.Prop>
                            </TextBox>

                            <TextBox x:Name="ui_grossproceeds"  Text="{m:Bind Path=f_grossproceeds}" Grid.Column="1" Margin="0" Grid.Row="12" TextWrapping="Wrap" HorizontalAlignment="Stretch" Height="25" VerticalAlignment="Stretch" >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_grossproceeds" />
                                </a:Data.Prop>
                            </TextBox>
                            <TextBox  x:Name="ui_totalcost"    Text="{m:Bind Path=f_totalcost}" FontWeight="Bold" Foreground="Red" Grid.Column="3" Margin="0" Grid.Row="11" TextWrapping="Wrap" IsReadOnly="True" Height="25" VerticalAlignment="Stretch" >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_totalcost" Default="0"
									/>
                                </a:Data.Prop>
                            </TextBox>
                            <TextBox Text="{m:Bind Path=f_OrdinaryNum}"  x:Name="ui_OrdinaryNum"  Grid.Column="1" Margin="0" Grid.Row="16" TextWrapping="Wrap" Grid.ColumnSpan="1" Height="25" VerticalAlignment="Stretch" >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_OrdinaryNum" />
                                </a:Data.Prop>
                            </TextBox>
                            <TextBox Text="{m:Bind Path=f_limitbuygas}"  Grid.Column="1" Margin="0" TextWrapping="Wrap" Grid.ColumnSpan="1" IsReadOnly="True" Grid.Row="10" Height="25" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_limitbuygas" 
									Value="{m:Exp Str='openxiangou.Result!=null:openxiangou.Result,userfile.DataContext.f_usertype==$民用$:(single[data.name\=\=$民用月限购气量$].ToObjectList().First().value.ToInt()),userfile.DataContext.f_usertype==$非民用$:gsxiangou.f_gscustomgas,0'}"/>
                                </a:Data.Prop>
                            </TextBox>
                            <Button Content="修改"  Margin="0,0,0,1" Width="34" Grid.Row="10" Grid.Column="2"
							Click="{m:Exp Str='openxiangou.IsOpen=True'}" HorizontalAlignment="Left" />
                            <TextBox Text="{m:Bind Path=f_meternumber}"  Grid.Column="5" Margin="0" Grid.Row="3" TextWrapping="Wrap" IsReadOnly="True" Height="25" VerticalAlignment="Stretch" >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_meternumber" Value="{m:Exp Str=userfiles1.f_meternumber}" />
                                </a:Data.Prop>
                            </TextBox>

                            <StackPanel Grid.ColumnSpan="2" Margin="0,2" Grid.Row="7" Orientation="Horizontal" Grid.Column="4"/>

                            <TextBlock Text="付款方式：" Grid.Column="2" Margin="70,6,0,-1" TextWrapping="Wrap" TextAlignment="Right" Grid.Row="10" Height="25"/>
                            <ComboBox DisplayMemberPath="name" SelectedValuePath="name" ItemsSource="{m:Exp Str=paylist}" SelectedValue="{m:Bind Path=f_payment}"  Grid.Column="3" Margin="0" Grid.Row="10" HorizontalAlignment="Stretch" Width="Auto" Height="25" >
                                <a:Data.Prop>
                                    <o:PropertySetter  PropertyName="f_payment"
									Default="{m:Exp Str='paylist.Count > 0 :paylist.First().name,null'}" />
                                </a:Data.Prop>
                            </ComboBox>
                            <TextBox Text="{m:Bind Path=f_sgoperator}" Grid.Column="1" Margin="0" Grid.Row="13" TextWrapping="Wrap" IsReadOnly="True" HorizontalAlignment="Stretch" Height="25" VerticalAlignment="Stretch" >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_sgoperator" 
									Default="{m:Exp Str=LoginUser.name}"/>
                                </a:Data.Prop>
                            </TextBox>
                            <TextBox Text="{m:Bind Path=f_givechange}"  Grid.Column="5" Margin="0" TextWrapping="Wrap" Grid.ColumnSpan="1" IsReadOnly="True" Grid.Row="11" Height="25" VerticalAlignment="Stretch"  >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_givechange" Default="0"
								Value="{m:Exp Str=userfilego.f_grossproceeds-userfilego.f_totalcost}"/>
                                </a:Data.Prop>
                            </TextBox>

                            <!--隐藏域-->
                            <TextBox Text="{m:Bind Path=f_zongleiji}" Visibility="Collapsed"   Margin="0,6" TextWrapping="Wrap"  IsReadOnly="True" Height="Auto" VerticalAlignment="Stretch"  >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_zongleiji" Value="{m:Exp Str=userfiles1.f_cumulativepurchase\=>Completed}"/>
                                </a:Data.Prop>
                            </TextBox>
                            <TextBox Text="{m:Bind Path=f_biaoleiji}" Visibility="Collapsed"  Margin="0,6" TextWrapping="Wrap" Grid.ColumnSpan="1" IsReadOnly="True" Height="Auto" VerticalAlignment="Stretch"  >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_biaoleiji" Value="{m:Exp Str=userfiles1.f_metergasnums\=>Completed}"/>
                                </a:Data.Prop>
                            </TextBox>
                            <TextBox Text="{m:Bind Path=f_aliasname}"    Margin="0" TextWrapping="Wrap"  IsReadOnly="True" Height="25" VerticalAlignment="Stretch" Grid.Row="13" Grid.ColumnSpan="1" Grid.Column="5" HorizontalAlignment="Stretch" Width="Auto"  >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_aliasname" Value="{m:Exp Str=userfiles1.f_aliasname}" NotNull="True"/>
                                </a:Data.Prop>
                            </TextBox>
                            <!--写卡次数-->
                            <TextBox Name="times" Text="{m:Bind Path=f_times}"    Margin="8,0,0,0" TextWrapping="Wrap"  IsReadOnly="True" Height="Auto" VerticalAlignment="Stretch" HorizontalAlignment="Left" Width="39" Visibility="Collapsed"  >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_times" Value="{m:Exp Str='userfiles1.f_times' }"/>
                                </a:Data.Prop>
                            </TextBox>
                            <!--气价类型-->
                            <TextBox Text="{m:Bind Path=f_gaspricetype}" Visibility="Collapsed"   Margin="0,6" TextWrapping="Wrap"  IsReadOnly="True" Height="Auto" VerticalAlignment="Stretch"  >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_gaspricetype" Value="{m:Exp Str=userfiles1.f_gaspricetype}"/>
                                </a:Data.Prop>
                            </TextBox>
                            <TextBlock Margin="0" Grid.Row="14" TextWrapping="Wrap" Text="分  公  司：" TextAlignment="Right" Height="25"/>
                            <TextBox Text="{m:Bind Path=f_filiale}" Grid.Column="1" Margin="0" Grid.Row="14" TextWrapping="Wrap" IsReadOnly="True" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Height="25"  >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_filiale" 
									Default="{m:Exp Str=LoginUser.f_fengongsi}"/>
                                </a:Data.Prop>
                            </TextBox>
                            <TextBlock Text="分公司编号：" Visibility="Collapsed" Margin="0,6,0,0" TextWrapping="Wrap" TextAlignment="Right" Grid.Row="13"  Grid.Column="2" Height="25" />
                            <TextBox Text="{m:Bind Path=f_fengongsinum}" Visibility="Collapsed"  Grid.Column="3" Margin="0" Grid.Row="13" TextWrapping="Wrap" IsReadOnly="True"  VerticalAlignment="Stretch" HorizontalAlignment="Stretch" RenderTransformOrigin="0.496,1.37" Height="25">
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_fengongsinum" NotNull="True"
									Default="{m:Exp Str=LoginUser.f_fengongsinum}"/>
                                </a:Data.Prop>
                            </TextBox>
                            <TextBlock Margin="0,6,0,-1" Grid.Row="7" TextWrapping="Wrap" Text="民用气量：" Height="25" TextAlignment="Right" HorizontalAlignment="Left" Width="130"/>
                            <TextBlock Grid.Column="2" Margin="0,6,0,0" Grid.Row="7" TextWrapping="Wrap" Text="民用气量金额：" Height="25" TextAlignment="Right"/>
                            <TextBlock Grid.Column="4" Margin="0,6,0,0" Grid.Row="7" TextWrapping="Wrap" Text="非民用气量：" Height="25" TextAlignment="Right"/>
                            <TextBlock Margin="0,6,0,0" Grid.Row="8" TextWrapping="Wrap" Text="非民用气量金额：" Height="25" TextAlignment="Right"/>
                            <TextBox Text="{m:Bind Path=f_myqiliang}" Grid.Column="1" Margin="0" IsReadOnly="True" Grid.Row="7" TextWrapping="Wrap" Height="25">
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_myqiliang" Value="{m:Exp Str=userfilego.f_pregas*userfilego.f_myfenzhi}" />
                                </a:Data.Prop>
                            </TextBox>
                            <TextBox Text="{m:Bind Path=f_myqiliangjine}" Grid.Column="3" Margin="0" IsReadOnly="True" Grid.Row="7" TextWrapping="Wrap" Height="25">
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_myqiliangjine" Value="{m:Exp Str=userfilego.f_myqiliang*userfilego.f_myprice}" />
                                </a:Data.Prop>
                            </TextBox>
                            <TextBox Text="{m:Bind Path=f_feimyqiliang}" Grid.Column="5" Margin="0" IsReadOnly="True" Grid.Row="7" TextWrapping="Wrap" Height="25" VerticalAlignment="Stretch">
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_feimyqiliang" Value="{m:Exp Str=userfilego.f_pregas*userfilego.f_gsfenzhi}" />
                                </a:Data.Prop>
                            </TextBox>
                            <TextBox Text="{m:Bind Path=f_feimyqiliangjine}" Grid.Column="1" Margin="0" IsReadOnly="True" Grid.Row="8" TextWrapping="Wrap" Height="25">
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_feimyqiliangjine" Value="{m:Exp Str=userfilego.f_feimyqiliang*userfilego.f_gsprice}" />
                                </a:Data.Prop>
                            </TextBox>
                            <TextBlock Margin="0,6,0,0" Grid.Row="3" TextWrapping="Wrap" Text="混合气价：" Height="25" TextAlignment="Right"/>
                            <StackPanel Grid.ColumnSpan="4" Grid.Column="1" Visibility="{m:Exp Str=userfile.DataContext.f_gasproperties\=\=$混合型$:$Visible$\,$Collapsed$}" Margin="0,2,-11,2" Grid.Row="3" Orientation="Horizontal" Height="25"  >
                                <TextBlock Text="民用气价" HorizontalAlignment="Left" TextWrapping="Wrap" Margin="0,2" />
                                <TextBox Text="{m:Bind Path=f_myprice}" Margin="5,0,0,0" TextWrapping="Wrap" IsReadOnly="True" Height="25" >
                                    <a:Data.Prop>
                                        <o:PropertySetter PropertyName="f_myprice" Value="{m:Exp Str=userfiles1.f_myprice\=>Completed}" />
                                    </a:Data.Prop>
                                </TextBox>
                                <TextBlock Text="所占比率" HorizontalAlignment="Left" TextWrapping="Wrap" Margin="10,2,0,2" />
                                <TextBox Text="{m:Bind Path=f_myfenzhi}" Margin="5,0,0,0" TextWrapping="Wrap" IsReadOnly="True" Height="25" >
                                    <a:Data.Prop>
                                        <o:PropertySetter PropertyName="f_myfenzhi" Value="{m:Exp Str=userfiles1.f_myfenzhi\=>Completed}" />
                                    </a:Data.Prop>
                                </TextBox>
                                <TextBlock Text="非民用气价" HorizontalAlignment="Left" TextWrapping="Wrap" Margin="10,2,0,2" />
                                <TextBox Text="{m:Bind Path=f_gsprice}" Margin="5,0,0,0" TextWrapping="Wrap" IsReadOnly="True" Height="25" >
                                    <a:Data.Prop>
                                        <o:PropertySetter PropertyName="f_gsprice" Value="{m:Exp Str=userfiles1.f_gsprice\=>Completed}"  />
                                    </a:Data.Prop>
                                </TextBox>
                                <TextBlock Text="所占比率" HorizontalAlignment="Left" TextWrapping="Wrap" Margin="10,2,0,2" />
                                <TextBox Text="{m:Bind Path=f_gsfenzhi}" Margin="5,0,0,0" TextWrapping="Wrap" IsReadOnly="True" Height="25" >
                                    <a:Data.Prop>
                                        <o:PropertySetter PropertyName="f_gsfenzhi" Value="{m:Exp Str=userfiles1.f_gsfenzhi\=>Completed}"  />
                                    </a:Data.Prop>
                                </TextBox>
                            </StackPanel>
                            <TextBlock Grid.Column="4" Margin="0" Grid.Row="9" Foreground="Red" TextWrapping="Wrap" Text="档案编号：" TextAlignment="Right" Height="25"/>
                            <TextBox Text="{Binding f_userinfoid}"  Grid.Column="5" Margin="0" Grid.Row="9" IsEnabled="True" Height="25" VerticalAlignment="Stretch" IsReadOnly="True"  >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_userinfoid"
								    Value="{m:Exp Str=userfiles1.f_userinfoid}"/>
                                </a:Data.Prop>
                            </TextBox>
                            <TextBlock Text="别      名：" Margin="0" TextWrapping="Wrap" TextAlignment="Right" Grid.Column="4" Grid.Row="13" Height="25"/>
                            <TextBox Text="{m:Bind Path=f_type}"    Margin="0" TextWrapping="Wrap"  IsReadOnly="True" Height="25" VerticalAlignment="Stretch" Grid.Row="14" Grid.ColumnSpan="1" Grid.Column="5" HorizontalAlignment="Stretch" Width="Auto" Grid.RowSpan="1" d:LayoutOverrides="VerticalAlignment"  >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_type" Value="{m:Exp Str=userfiles1.f_type}" NotNull="True"/>
                                </a:Data.Prop>
                            </TextBox>
                            <TextBlock Text="类　　型：" Margin="0" TextWrapping="Wrap" TextAlignment="Right" Grid.Column="4" Grid.Row="14" Height="25" d:LayoutOverrides="VerticalAlignment"/>
                            <TextBox Text="{m:Bind Path=f_watchnum}"    Margin="0" TextWrapping="Wrap"  IsReadOnly="True" Height="25" VerticalAlignment="Stretch" Grid.Row="14" Grid.ColumnSpan="1" Grid.Column="3" HorizontalAlignment="Stretch" Width="Auto" Grid.RowSpan="1"  >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_watchnum" Value="{m:Exp Str=userfiles1.f_watchnum}" NotNull="True"/>
                                </a:Data.Prop>
                            </TextBox>
                            <TextBlock Text="海力表型编码：" Margin="0" TextWrapping="Wrap" TextAlignment="Right" Grid.Column="2" Grid.Row="14" Height="25"/>
                            <TextBox Text="{m:Bind Path=f_maichong}" Margin="0" TextWrapping="Wrap"  IsReadOnly="True" Height="25" VerticalAlignment="Stretch" Grid.Row="15" Grid.ColumnSpan="1" Grid.Column="3" HorizontalAlignment="Stretch" Width="Auto" Grid.RowSpan="1"  >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_maichong" Value="{m:Exp Str=userfiles1.f_maichong}" NotNull="True"/>
                                </a:Data.Prop>
                            </TextBox>
                            <TextBlock Text="脉冲/表系数：" Margin="0" TextWrapping="Wrap" TextAlignment="Right" Grid.Row="15" Height="25" Grid.Column="2"/>
                            <TextBlock Text="网　　点：" Margin="0" TextWrapping="Wrap" TextAlignment="Right" Grid.Row="15" Height="25"/>
                            <TextBox Text="{m:Bind Path=f_sgnetwork}" Grid.Column="1" Margin="0" Grid.Row="15" TextWrapping="Wrap" IsReadOnly="True" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Height="25"  >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_sgnetwork" 
									Default="{m:Exp Str=LoginUser.f_parentname}"/>
                                </a:Data.Prop>
                            </TextBox>

                            <TextBox Text="{m:Bind Path=f_OrgStr}"  Grid.Column="5" Margin="0,4,77,1" Grid.Row="0" TextWrapping="Wrap" IsReadOnly="True"  VerticalAlignment="Stretch" HorizontalAlignment="Right" Height="25" Width="4" d:LayoutOverrides="HorizontalAlignment" Visibility="Collapsed" >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_OrgStr" NotNull="True"
										Value="{m:Exp Str=LoginUser.orgpathstr}" Default="{m:Exp Str=userfilego.f_OrgStr}"/>
                                </a:Data.Prop>
                            </TextBox>

                            <TextBox Text="{m:Bind Path=f_apartment}" Grid.Column="4" Grid.Row="15" TextWrapping="Wrap" IsReadOnly="True" Height="25" VerticalAlignment="Stretch" Margin="0,3,0,2" HorizontalAlignment="Right" Width="2" RenderTransformOrigin="0.5,0.5" >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_apartment" Value="{m:Exp Str=userfiles1.f_apartment\=>Completed}" />
                                </a:Data.Prop>
                            </TextBox>

                            <TextBlock Grid.Column="2" Margin="0" Grid.Row="13" TextWrapping="Wrap" TextAlignment="Right" Height="25"><Run Text="购气"/><Run Text="时间"/><Run Text="："/></TextBlock>
                            <toolkit:TimePicker Value="{m:Bind Path=f_deliverytime}" IsEnabled="False" Grid.Column="3" Margin="0,3,0,2" Grid.Row="13"   IsDropDownOpen="False"  VerticalAlignment="Stretch" Height="25" HorizontalAlignment="Stretch" Width="Auto" Grid.ColumnSpan="1" >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_deliverytime" Value="{m:Exp Str=SecRefresh\=&gt;TimeEvent!\=null:SysTime.Now\,$$}"/>
                                </a:Data.Prop>
                            </toolkit:TimePicker>
                            <TextBox Text="{m:Bind Path=f_cardidjia}" Grid.Column="3" Margin="0,3,1,2" Grid.Row="4" TextWrapping="Wrap" IsReadOnly="True" Height="25" HorizontalAlignment="Right" Width="1" >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_cardidjia" Value="{m:Exp Str=userfile.DataContext.f_cardid!\=null:userfile.DataContext.f_cardid.ToLong()\+1\,null}"
								NotNull="True"/>
                                </a:Data.Prop>
                            </TextBox>
                            <TextBlock Text="收费类型：" Margin="0" TextWrapping="Wrap" TextAlignment="Right" Grid.Row="11" Height="25"/>
                            <ComboBox DisplayMemberPath="name" SelectedValuePath="name" ItemsSource="{m:Exp Str=payfeetypelist}" SelectedValue="{m:Bind Path=f_payfeetype}"  Grid.Column="1" Margin="0" Grid.Row="11" Height="25" >
                                <a:Data.Prop>
                                    <o:PropertySetter  PropertyName="f_payfeetype"
									Default="{m:Exp Str=payfeetypelist.Count &gt; 0 :payfeetypelist.First().name\,null}" />
                                </a:Data.Prop>
                            </ComboBox>
                            <TextBox Text="{m:Bind Path=f_comtype}" Grid.Column="1" Margin="0,3,0,2" Grid.Row="14" TextWrapping="Wrap" IsReadOnly="True" VerticalAlignment="Stretch" HorizontalAlignment="Right" Height="25" Width="2"  >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_comtype" NotNull="True"
									Default="天然气公司"/>
                                </a:Data.Prop>
                            </TextBox>
                            <TextBox Text="{m:Bind Path=f_cailiaofei}"  Grid.Column="1" Margin="0,3,4,2" TextWrapping="Wrap" Grid.ColumnSpan="1" IsReadOnly="False" Grid.Row="4" Height="25" HorizontalAlignment="Stretch" Width="Auto"  >
                                <a:Data.Prop>
                                    <o:PropertySetter PropertyName="f_cailiaofei"/>
                                </a:Data.Prop>
                            </TextBox>
                        </Grid>
                    </toolkit:DockPanel>
                </Grid>
            </c:BusyIndicatorEx>
        </Grid>
        <!--国税发票打印-->
        <Grid x:Name="guoshuiprint"  Background="White"  HorizontalAlignment="Left" Width="800"  VerticalAlignment="Bottom" Margin="67,0,0,-626" d:LayoutOverrides="Width, Height" Height="571">
            <a:Data.Context>
                <o:GeneralObject  x:Name="fkprint" WebClientInfo="{StaticResource dbclient}" EntityType="t_sellinggas"  />
            </a:Data.Context>
            <Grid.RowDefinitions >
                <RowDefinition Height="30"/>
                <RowDefinition Height="30"/>
                <RowDefinition Height="30"/>
                <RowDefinition Height="23"/>
                <RowDefinition Height="35"/>
                <RowDefinition Height="35"/>
                <RowDefinition Height="35"/>
                <RowDefinition Height="35"/>
                <RowDefinition Height="35"/>
                <RowDefinition Height="35"/>
                <RowDefinition Height="35"/>
                <RowDefinition Height="22"/>
                <RowDefinition Height="23"/>
                <RowDefinition Height="3"/>
                <RowDefinition Height="22"/>
                <RowDefinition Height="25"/>
                <RowDefinition Height="25"/>
                <RowDefinition Height="25"/>
                <RowDefinition Height="25"/>
                <RowDefinition Height="25"/>
                <RowDefinition Height="25"/>
                <RowDefinition Height="25"/>
                <RowDefinition Height="31"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="139"/>
                <ColumnDefinition Width="0.241*"/>
                <ColumnDefinition Width="0.012*"/>
                <ColumnDefinition Width="0.104*"/>
                <ColumnDefinition Width="0.222*"/>
                <ColumnDefinition Width="0.101*"/>
                <ColumnDefinition Width="0.319*"/>
            </Grid.ColumnDefinitions>
            <!--<TextBlock Text="{m:Exp Str='SecRefresh\=&gt;TimeEvent!\=null:SysTime.Now.ToString($HH:mm:ss$),$$'}" Grid.Column="2" Margin="-54,4,-19,0" Grid.Row="3" TextWrapping="Wrap" VerticalAlignment="Stretch" d:LayoutOverrides="HorizontalAlignment"/>-->
            <sdk:Label HorizontalAlignment="Right" Margin="0,0,43,8" Width="14" Content="日" Grid.Column="1" Grid.Row="3" d:LayoutOverrides="HorizontalAlignment" RenderTransformOrigin="0.214,0.526"/>
            <sdk:Label HorizontalAlignment="Right" Margin="0,0,114,0" Width="14" Content="年" RenderTransformOrigin="0.406,0.694" Height="15" Grid.Row="3" VerticalAlignment="Top" Grid.Column="1"/>
            <sdk:Label HorizontalAlignment="Right" Margin="0,0,76,8" Width="15" Content="月" Grid.Column="1" Grid.Row="3" RenderTransformOrigin="-0.5,0.455"/>
            <sdk:Label Margin="0,8,1,4" Content="用户姓名：" FontSize="13.333" Grid.Row="4" HorizontalAlignment="Right" VerticalContentAlignment="Top"/>
            <sdk:Label Content="单　　价：" FontSize="13.333" Grid.Row="7" Grid.Column="4" Height="20" HorizontalAlignment="Right" VerticalContentAlignment="Top" Margin="0,14,-28,1" d:LayoutOverrides="HorizontalAlignment"/>
            <sdk:Label Margin="0,2,0,0" Content="地　　址：" Height="20" FontSize="13.333" Grid.Row="5" d:LayoutOverrides="VerticalAlignment" HorizontalAlignment="Right" VerticalContentAlignment="Top"/>
            <TextBlock Text="{m:Exp Str=SysTime.Now.ToString($yyyy$)}"  HorizontalAlignment="Left" Margin="-5,0,0,8" Grid.Row="3" TextWrapping="Wrap" Width="36" Grid.Column="1" d:LayoutOverrides="HorizontalAlignment"/>
            <TextBlock Text="{m:Exp Str=SysTime.Now.ToString($MM$)}" Grid.Column="1"  HorizontalAlignment="Right" Margin="0,0,92,8" Grid.Row="3" TextWrapping="Wrap" Width="18" Height="15" VerticalAlignment="Bottom"/>
            <TextBlock Text="{m:Exp Str=SysTime.Now.ToString($dd$)}" Grid.Column="1" Margin="83,0,57,8" Grid.Row="3" TextWrapping="Wrap" VerticalAlignment="Stretch"/>
            <sdk:Label Content="购 气 量：" FontSize="13.333" Grid.Row="6"  Height="20" VerticalContentAlignment="Top" Margin="0,15,-31,0" HorizontalAlignment="Right" Width="64" Grid.Column="4" d:LayoutOverrides="HorizontalAlignment"/>
            <sdk:Label Content="阶梯1气量：" FontSize="13.333" Grid.Row="7" Height="20" VerticalContentAlignment="Top" HorizontalAlignment="Right" Margin="0,12,0,3"/>
            <sdk:Label Content="用户卡号：" FontSize="13.333" Grid.Row="4" Grid.Column="3" VerticalContentAlignment="Top" Margin="0,8,0,4" HorizontalAlignment="Right"/>
            <TextBlock Text="61059070996822X" Grid.Column="3"  HorizontalAlignment="Stretch" Margin="-1,16,35,-1" Grid.Row="9" TextWrapping="Wrap" Width="Auto" Height="20" Grid.ColumnSpan="2"/>
            <TextBlock Text="{m:Exp Str=LoginUser.f_fapiaotaitu}" Grid.Column="1"  HorizontalAlignment="Stretch" Margin="0,15,0,0" Grid.Row="9" TextWrapping="Wrap" Width="Auto" Height="20"/>
            <TextBlock Text="{m:Exp Str=LoginUser.f_fgsdianhua}" Grid.Column="3" Margin="-1,5,70,10" Grid.Row="10" TextWrapping="Wrap" Height="20" Grid.ColumnSpan="2"/>
            <TextBlock Text="{m:Exp Str=sellgasobj.f_pregas}" Grid.Column="6" Margin="-32,15,0,0" Grid.Row="6" TextWrapping="Wrap" Height="20" VerticalAlignment="Stretch" HorizontalAlignment="Left" Width="111"/>
            <TextBlock Text="{m:Exp Str=userfile.DataContext.f_stair1amount}" Grid.Column="1" Margin="1,14,4,1" Grid.Row="6" TextWrapping="Wrap" Height="20" Grid.ColumnSpan="2"/>
            <TextBlock Text="{m:Exp Str=userfile.DataContext.f_stair1price}" Grid.Column="5" Margin="32,0,-30,1" Grid.Row="7" TextWrapping="Wrap" Height="20" VerticalAlignment="Bottom" d:LayoutOverrides="Height"/>
            <TextBlock Text="{m:Exp Str=sellgasobj.f_totalcost.ToChinaMoney()}" Grid.Column="1"  HorizontalAlignment="Stretch" Margin="6,13,6,2" Grid.Row="8" TextWrapping="Wrap" Width="Auto" Height="20"/>
            <TextBlock Text="{m:Exp Str=userfiles1.f_cardid}" Grid.Column="4"  HorizontalAlignment="Stretch" Margin="0,8,0,4" Grid.Row="4" TextWrapping="Wrap" Width="Auto" Height="20" VerticalAlignment="Stretch" Grid.ColumnSpan="1"/>
            <TextBlock Text="{m:Exp Str=userfiles1.f_username}" Grid.Column="1"  HorizontalAlignment="Stretch" Margin="0,8,-1,4" Grid.Row="4"  Width="Auto" VerticalAlignment="Stretch" Grid.ColumnSpan="2"/>
            <TextBlock Text="{m:Exp Str='(userfiles1.f_districtname\=\=null or userfiles1.f_apartment\=\=null):$\{userfiles1.f_address\}$\,$\{userfiles1.f_address\}\{userfiles1.f_districtname\}\{userfiles1.f_apartment\}$'}" Grid.Column="1"  HorizontalAlignment="Stretch" Margin="0,9,0,6" Grid.Row="5"  Width="Auto" Height="20" VerticalAlignment="Stretch" Grid.ColumnSpan="4"/>
            <TextBlock Text="{m:Exp Str=sellgasobj.f_preamount}" Grid.Column="6"  HorizontalAlignment="Stretch" Margin="-28,15,28,0" Grid.Row="8"  Width="Auto" Height="20"/>
            <sdk:Label Margin="0,14,-32,1" Content="气费金额：" FontSize="13.333" Grid.Row="8" Grid.Column="4" Height="20" HorizontalAlignment="Right" VerticalContentAlignment="Top" d:LayoutOverrides="HorizontalAlignment"/>
            <sdk:Label Content="大　　写：" FontSize="13.333" Grid.Row="8" Height="20" HorizontalAlignment="Right" VerticalContentAlignment="Top" Margin="0,13,3,2"/>
            <TextBlock Text="{m:Exp Str=userfiles1.f_usertype}" Grid.Column="6"  HorizontalAlignment="Stretch" Margin="15,7,10,5" Grid.Row="4" TextWrapping="Wrap" Width="Auto"/>
            <sdk:Label Margin="0,15,0,0" Content="公　　司：" FontSize="13.333" Grid.Row="9"  Height="20" HorizontalAlignment="Right" VerticalContentAlignment="Top"/>
            <sdk:Label Margin="9,-2,71,5" Content="网　　点：" FontSize="13.333" Grid.Row="3"  Height="20" VerticalContentAlignment="Top" Grid.Column="4" d:LayoutOverrides="Width"/>
            <sdk:Label Margin="0,4,0,-1" Content="操 作 员：" FontSize="13.333" Height="20" Grid.Row="10" HorizontalAlignment="Right" VerticalContentAlignment="Top"/>
            <TextBlock Text="{m:Exp Str=LoginUser.name}" Grid.Column="1"  HorizontalAlignment="Stretch" Margin="0,4,0,-1" Grid.Row="10" TextWrapping="Wrap" Width="Auto" Height="20"/>
            <TextBlock Text="{m:Exp Str=LoginUser.f_parentname}" Grid.Column="5" Margin="-65,-2,-31,5" Grid.Row="3" TextWrapping="Wrap" Height="20"/>
            <sdk:Label Content="小　　计：" FontSize="13.333" Grid.Row="9" Grid.Column="4" Height="20" HorizontalAlignment="Right" VerticalContentAlignment="Top" Margin="0,15,-32,0" d:LayoutOverrides="HorizontalAlignment"/>
            <sdk:Label Content="用户类型：" FontSize="13.333" Grid.Row="4" Grid.Column="5" HorizontalAlignment="Right" VerticalContentAlignment="Top" Margin="0,7,201,5" Width="72" Grid.ColumnSpan="2"/>
            <TextBlock Text="{m:Exp Str=sellgasobj.f_totalcost}" Grid.Column="6"  HorizontalAlignment="Stretch" Margin="-28,15,76,0" Grid.Row="9" TextWrapping="Wrap" Width="Auto" Height="20"/>

        </Grid>


        <!--奥枫发票打印-->
        <Grid Name="aofengprint" Background="b" Margin="-1524,-74,0,16"  Width="1125" Height="600" VerticalAlignment="Bottom" HorizontalAlignment="Left">
            <a:Data.Context>
                <o:GeneralObject  x:Name="fkprint1" WebClientInfo="{StaticResource dbclient}" EntityType="t_sellinggas"  />
            </a:Data.Context>


            <Path Data="M17,186 L492.26941,186" Height="1" Stretch="Fill" Stroke="Black" StrokeThickness="1" UseLayoutRounding="False" VerticalAlignment="Top" Margin="47.667,49.704,352.139,0"/>
            <Path Data="M72,0 L72,276.02899" Margin="47.631,49.602,0,251.294" Stretch="Fill" Stroke="Black" StrokeThickness="1" UseLayoutRounding="False" HorizontalAlignment="Left" Width="1"/>
            <Path Data="M17,186 L492.26941,186" Height="1" Stretch="Fill" Stroke="Black" StrokeThickness="1" UseLayoutRounding="False" VerticalAlignment="Top" 
Margin="47.667,79.038,352.139,0"/>
            <Path Data="M72,0 L72,276.02899" Margin="158.623,49.602,0,285.294" Stretch="Fill" Stroke="Black" StrokeThickness="1" UseLayoutRounding="False" 
HorizontalAlignment="Left" Width="1"/>
            <Path Data="M17,186 L492.26941,186" Height="1" Stretch="Fill" Stroke="Black" StrokeThickness="1" UseLayoutRounding="False" VerticalAlignment="Top" 
Margin="47.667,109.706,352.139,0"/>
            <Path Data="M72,0 L72,276.02899" Margin="0,47.602,351.377,253" Stretch="Fill" Stroke="Black" StrokeThickness="1" UseLayoutRounding="False" 
HorizontalAlignment="Right" Width="1"/>
            <Path Data="M17,186 L492.26941,186" Height="1" Stretch="Fill" Stroke="Black" StrokeThickness="1" UseLayoutRounding="False" VerticalAlignment="Top" 
Margin="159.623,211.382,352.139,0"/>
            <Path Data="M17,186 L492.26941,186" Height="1" Stretch="Fill" Stroke="Black" StrokeThickness="1" UseLayoutRounding="False" VerticalAlignment="Top" 
Margin="159.623,176.382,352.139,0"/>
            <Path Data="M17,186 L492.26941,186" Height="1" Stretch="Fill" Stroke="Black" StrokeThickness="1" UseLayoutRounding="False" VerticalAlignment="Bottom" 
Margin="47.667,0,353.139,320.285"/>
            <Path Data="M72,0 L72,276.02899" Margin="303.97,49.602,0,0" Stretch="Fill" Stroke="Black" StrokeThickness="1" UseLayoutRounding="False" 
HorizontalAlignment="Left" Width="1" Height="229.113" VerticalAlignment="Top"/>
            <Path Data="M72,0 L72,276.02899" Margin="411.306,51.602,0,0" Stretch="Fill" Stroke="Black" StrokeThickness="1" UseLayoutRounding="False" 
HorizontalAlignment="Left" Width="1" Height="222.113" VerticalAlignment="Top"/>
            <Path Data="M17,186 L492.26941,186" Stretch="Fill" Stroke="Black" StrokeThickness="1" UseLayoutRounding="False" 
Margin="47.667,0,352.139,250.294" Height="1" VerticalAlignment="Bottom"/>
            <Path Data="M72,0 L72,276.02899" Margin="0,214.602,471.013,288.398" Stretch="Fill" Stroke="Black" StrokeThickness="1" UseLayoutRounding="False" HorizontalAlignment="Right" Width="2" RenderTransformOrigin="0.5,0.5">
                <Path.RenderTransform>
                    <CompositeTransform ScaleX="-1"/>
                </Path.RenderTransform>
            </Path>
            <Path Data="M17,186 L492.26941,186" Height="1" Stretch="Fill" Stroke="Black" StrokeThickness="1" UseLayoutRounding="False" VerticalAlignment="Top" 
Margin="47.667,143,352.139,0"/>
            <Path Data="M72,0 L72,276.02899" Margin="525.987,110.602,0,320.285" Stretch="Fill" Stroke="Black" StrokeThickness="1" UseLayoutRounding="False" HorizontalAlignment="Left" Width="1"/>
            <sdk:Label Height="20" Margin="323.01,30.306,479.994,0" Content="         燃 气 公 司 收 费 收 据" VerticalAlignment="Top" FontSize="15" RenderTransformOrigin="0.5,0.5" UseLayoutRounding="False" d:LayoutRounding="Auto" >
                <sdk:Label.RenderTransform>
                    <CompositeTransform Rotation="0.263"/>
                </sdk:Label.RenderTransform>
            </sdk:Label>
            <sdk:Label HorizontalAlignment="Left" Content="档案编号" FontSize="15" Height="22" Margin="68,56,0,0" VerticalAlignment="Top" Width="63"/>
            <sdk:Label HorizontalAlignment="Left" Content="卡　　号" FontSize="15" Height="22" Margin="69,84,0,0" VerticalAlignment="Top" Width="63"/>
            <sdk:Label HorizontalAlignment="Left" Content="合计(大写):" FontSize="15" Margin="160,285,0,288" Width="73"/>
            <sdk:Label HorizontalAlignment="Left" Content="用户名称" FontSize="15" Height="22" Margin="322,54,0,0" VerticalAlignment="Top" Width="82"/>
            <sdk:Label HorizontalAlignment="Left" Content="用户地址" FontSize="15" Height="22" Margin="324,84,0,0" VerticalAlignment="Top" Width="63"/>
            <sdk:Label Content="合     计:" FontSize="15" Margin="69,286,984,289"/>
            <sdk:Label Content="操  作  员:" FontSize="15" Margin="392,0,666,255" Height="22" VerticalAlignment="Bottom"/>
            <sdk:Label  Content="网　点:"   HorizontalAlignment="Left" Height="25" Margin="88,0,0,255" FontSize="15" VerticalAlignment="Bottom" Width="61" RenderTransformOrigin="0.377,0.64"/>
            <sdk:Label HorizontalAlignment="Left" Content="购 气 量" FontSize="15" Height="22" Margin="334,118,0,0" VerticalAlignment="Top" Width="59"/>
            <sdk:Label Content=" 单　价(元)" FontSize="15" Height="22" Margin="212,118,0,0" VerticalAlignment="Top" HorizontalAlignment="Left" Width="92"/>
            <sdk:Label Content="金　额(元)" FontSize="15" Height="22" Margin="433,119,613,0" VerticalAlignment="Top"/>
            <sdk:Label HorizontalAlignment="Left" Content="     阶梯合计" FontSize="15" Margin="50,251,0,0" Width="108" Height="22" VerticalAlignment="Top"/>
            <TextBlock Text="{m:Exp Str=SecRefresh\=&gt;TimeEvent!\=null:SysTime.Now.ToString($yyyy-MM-dd HH:mm:ss$)\,$$}" Grid.Column="0"  HorizontalAlignment="Left" Margin="609,327,0,0" TextWrapping="Wrap" Width="159" Height="18" VerticalAlignment="Top"/>
            <TextBlock Text="{m:Exp Str=userfile.DataContext.f_stair1amount}" Margin="336,149,0,0" TextWrapping="Wrap" Height="20" VerticalAlignment="Top" Grid.ColumnSpan="1" HorizontalAlignment="Left" Width="59"/>
            <TextBlock Text="{m:Exp Str=userfile.DataContext.f_stair1price}" Margin="212,151,0,0" TextWrapping="Wrap" Height="20" VerticalAlignment="Top" HorizontalAlignment="Left" Width="92"/>
            <TextBlock Text="{m:Exp Str=sellgasobj.f_totalcost.ToChinaMoney()}"  HorizontalAlignment="Left" Margin="239,288,0,292" TextWrapping="Wrap" Width="320" Height="20"/>
            <TextBlock Text="{m:Exp Str=sellgasobj.f_username}"  HorizontalAlignment="Stretch" Margin="412,55,564,0"  Width="Auto" Height="20" VerticalAlignment="Top"/>
            <TextBlock Text="{m:Exp Str='$\{sellgasobj.f_address\}$'}"  HorizontalAlignment="Stretch" Margin="414,84,352,0"  Width="Auto" Height="20" VerticalAlignment="Top"/>
            <TextBlock Text="{m:Exp Str=userfiles1.f_userinfoid}"  HorizontalAlignment="Left" Margin="161,58,0,0"  Width="141" Height="20" VerticalAlignment="Top" Padding="0,2,0,0"/>
            <TextBlock Text="{m:Exp Str=sellgasobj.f_cardid}"  HorizontalAlignment="Left" Margin="161,85,0,0"  Width="143" Height="20" VerticalAlignment="Top" Padding="0,2,0,0"/>
            <TextBlock  Text="{m:Exp Str=userfile.DataContext.f_stair1fee.MathRound(2)).ToString($0.##$)}"  HorizontalAlignment="Right" Margin="0,151,610,0"  Width="79" Height="20" VerticalAlignment="Top"/>
            <TextBlock Text="{m:Exp Str=sellgasobj.f_sgnetwork}" Margin="161,0,0,253" TextWrapping="Wrap" Height="20" VerticalAlignment="Bottom" HorizontalAlignment="Left" Width="226"/>
            <TextBlock Text="{m:Exp Str=sellgasobj.f_sgoperator}"  HorizontalAlignment="Right" Margin="0,0,581,255" TextWrapping="Wrap" Width="80" Height="20" VerticalAlignment="Bottom"/>
            <Path Data="M72,0 L72,276.02899" Margin="561.306,51.602,0,0" Stretch="Fill" Stroke="Black" StrokeThickness="1" UseLayoutRounding="False" 
            	HorizontalAlignment="Left" Width="1" Height="26.398" VerticalAlignment="Top"/>
            <Path Data="M72,0 L72,276.02899" Margin="661.306,51.602,0,0" Stretch="Fill" Stroke="Black" StrokeThickness="1" UseLayoutRounding="False" 
            	HorizontalAlignment="Left" Width="1" Height="26.398" VerticalAlignment="Top"/>
            <sdk:Label HorizontalAlignment="Left" Content="用户类型" FontSize="15" Height="22" Margin="569,54,0,0" VerticalAlignment="Top" Width="82"/>
            <TextBlock Text="{m:Exp Str=userfiles1.f_usertype}"  HorizontalAlignment="Right" Margin="0,55,354,0"  Width="106" Height="20" VerticalAlignment="Top"/>
            <sdk:Label HorizontalAlignment="Left" Content="项       目" FontSize="15" Height="22" Margin="69,115,0,0" VerticalAlignment="Top" Width="63"/>
            <sdk:Label HorizontalAlignment="Left" Content="阶梯明细" FontSize="15" Height="22" Margin="69,181,0,0" VerticalAlignment="Top" Width="63"/>
            <TextBlock Text="{m:Exp Str=userfile.DataContext.f_stair2price}" Margin="212,185,0,0" TextWrapping="Wrap" Height="20" VerticalAlignment="Top" HorizontalAlignment="Left" Width="92"/>
            <TextBlock Text="{m:Exp Str=userfile.DataContext.f_stair2amount}" Margin="341,185,0,0" TextWrapping="Wrap" Height="20" VerticalAlignment="Top" Grid.ColumnSpan="1" HorizontalAlignment="Left" Width="59"/>
            <TextBlock Text="{m:Exp Str=userfile.DataContext.f_stair2fee.MathRound(2)).ToString($0.##$)}"  HorizontalAlignment="Right" Margin="0,184,610,0"  Width="79" Height="20" VerticalAlignment="Top"/>
            <Path Data="M17,186 L492.26941,186" Height="1" Stretch="Fill" Stroke="Black" StrokeThickness="1" UseLayoutRounding="False" VerticalAlignment="Top" 
            	Margin="47.667,241.382,352.139,0"/>
            <TextBlock Text="{m:Exp Str=sellgasobj.f_pregas}" Margin="336,252,0,0" TextWrapping="Wrap" Height="20" VerticalAlignment="Top" Grid.ColumnSpan="1" HorizontalAlignment="Left" Width="75"/>
            <TextBlock Text="{m:Exp Str=sellgasobj.f_preamount}"  HorizontalAlignment="Right" Margin="0,251,613,0"  Width="77" Height="20" VerticalAlignment="Top"/>
            <sdk:Label Content="小  写:" FontSize="15" Margin="586,285,473,290"/>
            <TextBlock Text="{m:Exp Str=sellgasobj.f_preamount}"  HorizontalAlignment="Right" Margin="0,288,351,0"  Width="69" Height="20" VerticalAlignment="Top"/>
            <sdk:Label Content="日   期:" FontSize="15" Margin="550,323,521,252"/>

            <Path Data="M72,0 L72,276.02899" Margin="0,107.602,468.013,393.398" Stretch="Fill" Stroke="Black" StrokeThickness="1" UseLayoutRounding="False" HorizontalAlignment="Right" Width="2" RenderTransformOrigin="0.5,0.5">
                <Path.RenderTransform>
                    <CompositeTransform ScaleX="-1"/>
                </Path.RenderTransform>
            </Path>
            <sdk:Label Content="实际表号" FontSize="15" Height="22" Margin="574,118,472,0" VerticalAlignment="Top"/>
            <sdk:Label Content="虚拟表号" FontSize="15" Height="22" Margin="676,118,370,0" VerticalAlignment="Top"/>
            <TextBlock Text="{m:Exp Str=userfiles1.f_meternumber}"  HorizontalAlignment="Right" Margin="0,151,489,0"  Width="86" Height="20" VerticalAlignment="Top"/>
            <TextBlock Text="{m:Exp Str=userfiles1.f_meternumber1}"  HorizontalAlignment="Right" Margin="0,149,369,0"  Width="86" Height="20" VerticalAlignment="Top"/>
            <sdk:Label  Content="(白)存根联  （红）记账联  （绿）收款联  （黄） 客户联                  每月25日前凭客户联换发票"   HorizontalAlignment="Left" Height="25" Margin="50,0,0,223" FontSize="15" VerticalAlignment="Bottom" Width="724" RenderTransformOrigin="0.377,0.64"/>
            <Path Data="M17,186 L492.26941,186" Stretch="Fill" Stroke="Black" StrokeThickness="1" UseLayoutRounding="False" 
            	Margin="47.667,0,352.139,284.294" Height="1" VerticalAlignment="Bottom"/>
            <TextBlock Text="{m:Exp Str=userfile.DataContext.f_stair3price}" Margin="212,217,0,0" TextWrapping="Wrap" Height="20" VerticalAlignment="Top" HorizontalAlignment="Left" Width="92"/>
            <TextBlock Text="{m:Exp Str=userfile.DataContext.f_stair3amount}" Margin="341,216,0,0" TextWrapping="Wrap" Height="20" VerticalAlignment="Top" Grid.ColumnSpan="1" HorizontalAlignment="Left" Width="59"/>
            <TextBlock Text="{m:Exp Str=userfile.DataContext.f_stair3fee.MathRound(2)).ToString($0.##$)}"  HorizontalAlignment="Right" Margin="0,217,610,0"  Width="79" Height="20" VerticalAlignment="Top"/>

        </Grid>
        <Grid x:Name="fazheprint"  Background="White"  HorizontalAlignment="Left" Width="523"  VerticalAlignment="Bottom" Margin="-700,0,0,-756" Grid.ColumnSpan="1" Height="604">
            <a:Data.Context>
                <o:GeneralObject  Name="fzprint" WebClientInfo="{StaticResource dbclient}" 
		EntityType="t_fazhe"  >

                </o:GeneralObject>
            </a:Data.Context>
            <Grid.RowDefinitions >
                <RowDefinition Height="32"/>
                <RowDefinition Height="32"/>
                <RowDefinition Height="32"/>
                <RowDefinition Height="32"/>
                <RowDefinition Height="32"/>
                <RowDefinition Height="32"/>
                <RowDefinition Height="32"/>
                <RowDefinition Height="32"/>
                <RowDefinition Height="32"/>
                <RowDefinition Height="32"/>

            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="110"/>
                <ColumnDefinition Width="0.38*"/>
                <ColumnDefinition Width="100"/>
                <ColumnDefinition Width="0.62*"/>
            </Grid.ColumnDefinitions>
            <sdk:Label Margin="0,5,0,0" Content="用户姓名：" Visibility="Collapsed" FontSize="13.333" Grid.Row="1" Height="25" HorizontalAlignment="Right" VerticalContentAlignment="Top"/>
            <sdk:Label Content="安 装 人：" FontSize="13.333" Grid.Row="7" Visibility="Collapsed" Height="25" HorizontalAlignment="Right" VerticalContentAlignment="Top"/>
            <sdk:Label Content="其　　他：" FontSize="13.333" Grid.Row="8" Visibility="Collapsed" Height="25" HorizontalAlignment="Right" VerticalContentAlignment="Top"/>
            <sdk:Label Content="安装时间：" FontSize="13.333" Grid.Row="6" Visibility="Collapsed" Height="25" HorizontalAlignment="Right" VerticalContentAlignment="Top"/>
            <sdk:Label Content="用气项目：" FontSize="13.333" Grid.Row="5" Visibility="Collapsed" Height="25" HorizontalAlignment="Right" VerticalContentAlignment="Top"/>
            <sdk:Label Content="用气类别：" FontSize="13.333" Grid.Row="4" Visibility="Collapsed" Height="25" HorizontalAlignment="Right" VerticalContentAlignment="Top"/>
            <sdk:Label Content="入网时间：" FontSize="13.333" Grid.Row="3" Visibility="Collapsed" Height="25" HorizontalAlignment="Right" VerticalContentAlignment="Top"/>
            <sdk:Label Margin="0,5,0,0" Content="住　　址：" Visibility="Collapsed" FontSize="13.333" Grid.Row="2" Height="25" HorizontalAlignment="Right" VerticalContentAlignment="Top"/>
            <sdk:Label Margin="0,5,0,0" Content="用户编号：" Visibility="Collapsed" FontSize="13.333" Grid.Row="1" Height="25" HorizontalAlignment="Right" VerticalContentAlignment="Top" Grid.Column="2" d:LayoutOverrides="HorizontalAlignment"/>
            <TextBlock Text="{m:Exp Str=userfiles1.f_userid}" Grid.Column="1"  HorizontalAlignment="Stretch" Grid.Row="1"  Width="Auto" Height="25" Padding="0,2,0,0" Margin="0,0,0,7"/>
            <TextBlock Text="{m:Exp Str=SysTime.Now.ToString($yyyy$)}" Grid.Column="1"  HorizontalAlignment="Left" Margin="6,0,0,4" Grid.Row="6" TextWrapping="Wrap" Width="36" Height="18" VerticalAlignment="Bottom" d:LayoutOverrides="HorizontalAlignment, Height"/>
            <TextBlock Text="{m:Exp Str=SysTime.Now.ToString($MM$)}" Grid.Column="1" Margin="62,0,0,5" Grid.Row="6" TextWrapping="Wrap" Height="18" VerticalAlignment="Bottom" RenderTransformOrigin="-0.68,0.5" d:LayoutOverrides="Height" HorizontalAlignment="Left" Width="20"/>
            <TextBlock Text="{m:Exp Str=SysTime.Now.ToString($dd$)}" Grid.Column="1" Margin="97,9,0,0" Grid.Row="6" TextWrapping="Wrap" Height="18" VerticalAlignment="Top" d:LayoutOverrides="Height" HorizontalAlignment="Left" Width="17"/>
            <TextBlock Text="{m:Exp Str=userfiles1.f_gasmeteraccomodations}" Grid.Column="1"  HorizontalAlignment="Stretch" Grid.Row="5"  Width="Auto" Height="25" Padding="0,2,0,0" Margin="0,7,0,0"/>
            <TextBlock Text="{m:Exp Str=userfiles1.f_gaswatchbrand}" Grid.Column="1"  HorizontalAlignment="Stretch" Grid.Row="4"  Width="Auto" Height="25" Padding="0,2,0,0" Margin="0,7,0,0"/>
            <TextBlock Text="{m:Exp Str=userfiles1.f_address}" Grid.Column="1"  HorizontalAlignment="Stretch" Grid.Row="3"  Width="Auto" Height="25" Padding="0,2,0,0" Margin="0,7,0,0"/>
            <TextBlock Text="{m:Exp Str=userfiles1.f_username}" Grid.Column="3" Grid.Row="1" Height="25" Padding="0,2,0,0" Margin="22,0,76,7" d:LayoutOverrides="HorizontalAlignment"/>
            <TextBlock Text="{m:Exp Str=userfiles1.f_metertype}" Grid.Column="3"  HorizontalAlignment="Left" Grid.Row="3"  Width="133" Height="25" Padding="0,2,0,0" Margin="10,7,0,0"/>
            <TextBlock Text="{m:Exp Str=userfiles1.f_meternumber}" Grid.Column="3"  HorizontalAlignment="Stretch" Grid.Row="4"  Width="Auto" Height="25" Padding="0,2,0,0" Margin="10,7,61,0" d:LayoutOverrides="HorizontalAlignment"/>

            <Grid Grid.Row="13" Grid.ColumnSpan="4" Height="25" VerticalAlignment="Bottom" d:LayoutOverrides="GridBox" Margin="0,0,0,-12">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="16*"/>
                    <ColumnDefinition Width="14*"/>
                    <ColumnDefinition Width="14*"/>
                    <ColumnDefinition Width="14*"/>
                    <ColumnDefinition Width="14*"/>
                    <ColumnDefinition Width="14*"/>
                    <ColumnDefinition Width="14*"/>
                </Grid.ColumnDefinitions>

                <TextBlock Text="{m:Exp Str=SysTime.Now.ToString($yyyy-MM-dd$)}" FontSize="12" Grid.Row="0" Grid.Column="0" Height="17"  TextWrapping="Wrap" VerticalAlignment="Bottom" d:LayoutOverrides="Height"/>
                <TextBlock Text="{m:Exp Str=sellgasobj.f_payfeetype}" FontSize="12" Grid.Row="0" Grid.Column="1" Height="17"  TextWrapping="Wrap" VerticalAlignment="Bottom" d:LayoutOverrides="Height" />
                <TextBlock Text="{m:Exp Str=sellgasobj.f_amountmaintenance}" FontSize="12" Grid.Row="0" Grid.Column="2" Height="17"  TextWrapping="Wrap" VerticalAlignment="Bottom" d:LayoutOverrides="Height"/>
                <TextBlock Text="{m:Exp Str=sellgasobj.f_pregas}" FontSize="12" Grid.Row="0" Grid.Column="3" Height="17"  TextWrapping="Wrap" VerticalAlignment="Bottom" d:LayoutOverrides="Height" />
                <TextBlock Text="{m:Exp Str=sellgasobj.f_preamount}" FontSize="12" Grid.Row="0" Grid.Column="4" Height="17"  TextWrapping="Wrap" VerticalAlignment="Bottom" d:LayoutOverrides="Height" />
                <TextBlock Text="{m:Exp Str=sellgasobj.f_cumulativepurchase}" FontSize="12" Grid.Row="0" Grid.Column="5" Height="17"  TextWrapping="Wrap" VerticalAlignment="Bottom" d:LayoutOverrides="Height" />
                <TextBlock Text="{m:Exp Str=sellgasobj.f_sgoperator}" FontSize="12" Grid.Row="0" Grid.Column="6" Height="17"  TextWrapping="Wrap" VerticalAlignment="Bottom" d:LayoutOverrides="Height" />
            </Grid>
        </Grid>

        <!--打印收费票据-->
        <c:PrintObj Name="print"
		Message="是否打印发票"
		IsPrint="{m:Exp Str=card.State\=\=$End$ and single[data.name\=\=$发票格式$].First().value\=\=$奥枫发票格式$}" Area="{m:Res Key=aofengprint}" />
        <c:PrintObj Name="print1"
		Message="是否打印发票"
		IsPrint="{m:Exp Str=card.State\=\=$End$ and single[data.name\=\=$发票格式$].First().value\=\=$国税发票格式$}" Area="{m:Res Key=guoshuiprint}" />
        <!--c:PrintObj Name="zzprint"
		Message="是否打印购气证"
		IsPrint="{m:Exp Str=print1.State\=\=$End$ or print.State\=\=$End$ }" Area="{m:Res Key=fazheprint}" /-->
        <c:MessageTipObj Tip="{m:Exp Str=$制卡失败，请重试！如果继续失败，联系卡专家李树春18710336027。错误内容：\{card.Error\=\=null:$$\,card.Error\}$}" IsShow="{m:Exp Str=RollbackAction.State\=\=$End}"/>
        <c:MessageTipObj Tip="{m:Exp Str=$连接服务器失败，请重试！如果继续失败，请联系系统管理员。$}" IsShow="{m:Exp Str=SaveAction.State\=\=$Error}"/>
        <c:MessageTipObj Tip="{m:Exp Str=$自动冲正失败。库里有记录，卡上无气量，请转维修班处理。$}" IsShow="{m:Exp Str=RollbackAction.State\=\=$Error}"/>
    </Grid>
</UserControl>