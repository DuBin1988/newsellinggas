<UserControl x:Class="s2.户档案变更"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:a="clr-namespace:Com.Aote.Attachs;assembly=s2DLL" 
    xmlns:b="clr-namespace:Com.Aote.Behaviors;assembly=s2DLL"
    xmlns:o="clr-namespace:Com.Aote.ObjectTools;assembly=s2DLL"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:m="clr-namespace:Com.Aote.Marks;assembly=s2DLL"
    xmlns:sdk="http://schemas.microsoft.com/winfx/2006/xaml/presentation/sdk"
    xmlns:toolkit="http://schemas.microsoft.com/winfx/2006/xaml/presentation/toolkit"
    xmlns:c="clr-namespace:Com.Aote.Controls;assembly=s2DLL"
    mc:Ignorable="d"
    FontSize="13" >
    <Grid x:Name="LayoutRoot" >
        <m:ResourceLoad >
			
            <o:ObjectList Name="shebeilist" WebClientInfo="{StaticResource dbclient}"  Path="from paramvalue where param.name='用气设备'"/>
			<!--交费类型列表-->
            <o:ObjectList Name="jiaofeilist" WebClientInfo="{StaticResource dbclient}" Path="from paramvalue where param.name='交费类型'"/>
            <!--气表品牌列表-->
            <o:ObjectList Name="pinpailist" WebClientInfo="{StaticResource dbclient}" Path="{m:Exp Str=$from qibiao as qibiao left join fetch qibiao.qbnumber}"/>
            <!--抄表员列表-->
            <o:ObjectList Name="inputtorlist" EntityType="t_inputtor" WebClientInfo="{StaticResource dbclient}"  Path="{m:Exp Str=$from t_inputtor}"  HasEmptyRow="False"/>
           <!--用户对象-->
            <o:GeneralObject Name="userinfogo" WebClientInfo="{StaticResource dbclient}" 
					EntityType="t_userinfo"  IsInit="{m:Exp Str=SaveAction.State\=\=$End$}"
					Path="{m:Exp Str=areafiles.SelectedItem!\=null:$one/from t_userinfo as apply left join fetch apply.f_device where f_filiale\=\'\{LoginUser.f_fengongsi\}\' and  f_userid\=\'\{areafiles.SelectedItem.f_userid\}\'$\,$null$}">
						<o:PropertySetter PropertyName="f_stair1amount" NoDependValue="{m:Exp Str=CoboxStair.SelectedItem.f_stair1amount}"  />
						<o:PropertySetter PropertyName="f_stair1price" NoDependValue="{m:Exp Str=CoboxStair.SelectedItem.f_stair1price}"  />
						<o:PropertySetter PropertyName="f_stair2amount" NoDependValue="{m:Exp Str=CoboxStair.SelectedItem.f_stair2amount}"  />
						<o:PropertySetter PropertyName="f_stair2price" NoDependValue="{m:Exp Str=CoboxStair.SelectedItem.f_stair2price}"  />
						<o:PropertySetter PropertyName="f_stair3amount" NoDependValue="{m:Exp Str=CoboxStair.SelectedItem.f_stair3amount}"  />
						<o:PropertySetter PropertyName="f_stair3price" NoDependValue="{m:Exp Str=CoboxStair.SelectedItem.f_stair3price}"  />
						<o:PropertySetter PropertyName="f_stair4price" NoDependValue="{m:Exp Str=CoboxStair.SelectedItem.f_stair4price}"  />
						<o:PropertySetter PropertyName="f_stairmonths" NoDependValue="{m:Exp Str=CoboxStair.SelectedItem.f_stairmonths}"  /> 
						<o:PropertySetter PropertyName="f_stairtype" NoDependValue="{m:Exp Str=userfileschangeset.f_stairtypechange}" />	
						<o:PropertySetter PropertyName="f_username" NoDependValue="{m:Exp Str=userfileschangeset.f_usernamechange}" />							
						<o:PropertySetter PropertyName="f_districtname" NoDependValue="{m:Exp Str=userfileschangeset.f_districtnamechange}" />							
						<o:PropertySetter PropertyName="f_cusDy" NoDependValue="{m:Exp Str=userfileschangeset.f_cusDychange}" />							
						<o:PropertySetter PropertyName="f_cusFloor" NoDependValue="{m:Exp Str=userfileschangeset.f_cusFloorchange}" />							
						<o:PropertySetter PropertyName="f_address" NoDependValue="{m:Exp Str=userfileschangeset.f_addresschange}" />							
						<o:PropertySetter PropertyName="f_apartment" NoDependValue="{m:Exp Str=userfileschangeset.f_apartmentchange}" />							
						<o:PropertySetter PropertyName="f_phone" NoDependValue="{m:Exp Str=userfileschangeset.f_phonechange}" />							
						<o:PropertySetter PropertyName="f_credentials" NoDependValue="{m:Exp Str=userfileschangeset.f_credentialschange}" />							
						<o:PropertySetter PropertyName="f_idnumber" NoDependValue="{m:Exp Str=userfileschangeset.f_idnumberchange}" />							
						<o:PropertySetter PropertyName="f_inputtor" NoDependValue="{m:Exp Str=userfileschangeset.f_inputtorchange}" />							
						<o:PropertySetter PropertyName="f_inputtorphone" NoDependValue="{m:Exp Str=userfileschangeset.f_inputtorphonechange}" />							
						<o:PropertySetter PropertyName="f_payment" NoDependValue="{m:Exp Str=userfileschangeset.f_paymentchange}" />							
						<o:PropertySetter PropertyName="f_gasproperties" NoDependValue="{m:Exp Str=userfileschangeset.f_gaspropertieschange}" />							
						<o:PropertySetter PropertyName="f_stairtype" NoDependValue="{m:Exp Str=userfileschangeset.f_stairtypechange}" />								
						<o:PropertySetter PropertyName="f_bankname" NoDependValue="{m:Exp Str=userfileschangeset.f_banknamechange}" />							
						<o:PropertySetter PropertyName="f_idofcard" NoDependValue="{m:Exp Str=userfileschangeset.f_idofcardchange}" />												
						<o:PropertySetter PropertyName="f_device" Default="{m:Exp Str=devicelist}"/>
			</o:GeneralObject>
			<!--表对象列表-->
            <o:ObjectList Name="userfilelist" WebClientInfo="{StaticResource dbclient}" 
					EntityType="t_userfiles"  IsClear="{m:Exp Str=SaveAction.State\=\=$End$}"
					Path="{m:Exp Str=areafiles.SelectedItem!\=null:$from t_userfiles where f_filiale\=\'\{LoginUser.f_fengongsi\}\' and f_userinfoid\=\'\{areafiles.SelectedItem.f_userid\}\'$\,$null$}">
						<o:PropertySetter PropertyName="f_stair1amount" NoDependValue="{m:Exp Str=CoboxStair.SelectedItem.f_stair1amount}"  />
						<o:PropertySetter PropertyName="f_stair1price" NoDependValue="{m:Exp Str=CoboxStair.SelectedItem.f_stair1price}"  />
						<o:PropertySetter PropertyName="f_stair2amount" NoDependValue="{m:Exp Str=CoboxStair.SelectedItem.f_stair2amount}"  />
						<o:PropertySetter PropertyName="f_stair2price" NoDependValue="{m:Exp Str=CoboxStair.SelectedItem.f_stair2price}"  />
						<o:PropertySetter PropertyName="f_stair3amount" NoDependValue="{m:Exp Str=CoboxStair.SelectedItem.f_stair3amount}"  />
						<o:PropertySetter PropertyName="f_stair3price" NoDependValue="{m:Exp Str=CoboxStair.SelectedItem.f_stair3price}"  />
						<o:PropertySetter PropertyName="f_stair4price" NoDependValue="{m:Exp Str=CoboxStair.SelectedItem.f_stair4price}"  />
						<o:PropertySetter PropertyName="f_stairmonths" NoDependValue="{m:Exp Str=CoboxStair.SelectedItem.f_stairmonths}"  /> 
						<o:PropertySetter PropertyName="f_stairtype" NoDependValue="{m:Exp Str=userfileschangeset.f_stairtypechange}" />					
						<o:PropertySetter PropertyName="f_username" NoDependValue="{m:Exp Str=userfileschangeset.f_usernamechange}" />							
						<o:PropertySetter PropertyName="f_districtname" NoDependValue="{m:Exp Str=userfileschangeset.f_districtnamechange}" />							
						<o:PropertySetter PropertyName="f_cusDy" NoDependValue="{m:Exp Str=userfileschangeset.f_cusDychange}" />							
						<o:PropertySetter PropertyName="f_cusFloor" NoDependValue="{m:Exp Str=userfileschangeset.f_cusFloorchange}" />							
						<o:PropertySetter PropertyName="f_address" NoDependValue="{m:Exp Str=userfileschangeset.f_addresschange}" />							
						<o:PropertySetter PropertyName="f_apartment" NoDependValue="{m:Exp Str=userfileschangeset.f_apartmentchange}" />							
						<o:PropertySetter PropertyName="f_phone" NoDependValue="{m:Exp Str=userfileschangeset.f_phonechange}" />							
						<o:PropertySetter PropertyName="f_credentials" NoDependValue="{m:Exp Str=userfileschangeset.f_credentialschange}" />							
						<o:PropertySetter PropertyName="f_idnumber" NoDependValue="{m:Exp Str=userfileschangeset.f_idnumberchange}" />							
						<o:PropertySetter PropertyName="f_inputtor" NoDependValue="{m:Exp Str=userfileschangeset.f_inputtorchange}" />							
						<o:PropertySetter PropertyName="f_inputtorphone" NoDependValue="{m:Exp Str=userfileschangeset.f_inputtorphonechange}" />							
						<o:PropertySetter PropertyName="f_payment" NoDependValue="{m:Exp Str=userfileschangeset.f_paymentchange}" />							
						<o:PropertySetter PropertyName="f_gasproperties" NoDependValue="{m:Exp Str=userfileschangeset.f_gaspropertieschange}" />							
						<o:PropertySetter PropertyName="f_stairtype" NoDependValue="{m:Exp Str=userfileschangeset.f_stairtypechange}" />								
						<o:PropertySetter PropertyName="f_bankname" NoDependValue="{m:Exp Str=userfileschangeset.f_banknamechange}" />							
						<o:PropertySetter PropertyName="f_idofcard" NoDependValue="{m:Exp Str=userfileschangeset.f_idofcardchange}" />												
						
			</o:ObjectList>

			<!--证件-->
            <o:ObjectList Name="zhengjianlist" WebClientInfo="{StaticResource dbclient}" Path="from paramvalue where param.name='证件类型'"/>
            <!--阶梯-->
			<o:ObjectList Name="stairl" WebClientInfo="{StaticResource dbclient}"
             	Path="{m:Exp Str=$from t_stairprice where f_branch\=\'\{LoginUser.f_fengongsi\}\'}"/>
            <!--用气性质-->
			<o:ObjectList Name="usegaslist" WebClientInfo="{StaticResource dbclient}" Path="from paramvalue where param.name like '%用气性质'"/>
             <!--用气设备信息-->
			<o:ObjectList Name="devicelist" Source="{m:Exp Str=userinfogo.f_device\=>DataLoaded}" EntityType="t_devices" ></o:ObjectList>
			<b:BatchExcuteAction Name="SaveAction" WebClientInfo="{StaticResource dbclient}">
				 <b:BatchInfo Source="{m:Exp Str=userinfogo}" MethodName="SaveToJson"/>
				 <b:BatchInfo Source="{m:Exp Str=userfilelist}" MethodName="SaveToJson"/>
				 <b:BatchInfo Source="{m:Exp Str=userfileschangeset}" MethodName="SaveToJson"/>
			</b:BatchExcuteAction>

			
			<o:GeneralObject Name="userfileschangeset" 
				WebClientInfo="{StaticResource dbclient}" 
				EntityType="t_userfileschange"  
				IsInit="{m:Exp Str=SaveAction.State\=\=$End$}">
					<o:PropertySetter PropertyName="f_userid" NoDependValue="{m:Exp Str=userinfogo.f_userid}" />
					<o:PropertySetter PropertyName="f_username" NoDependValue="{m:Exp Str=userinfogo.f_username}" />							
					<o:PropertySetter PropertyName="f_districtname" NoDependValue="{m:Exp Str=userinfogo.f_districtname}" />							
					<o:PropertySetter PropertyName="f_cusDy" NoDependValue="{m:Exp Str=userinfogo.f_cusDy}" />							
					<o:PropertySetter PropertyName="f_cusFloor" NoDependValue="{m:Exp Str=userinfogo.f_cusFloor}" />							
					<o:PropertySetter PropertyName="f_address" NoDependValue="{m:Exp Str=userinfogo.f_address}" />							
					<o:PropertySetter PropertyName="f_apartment" NoDependValue="{m:Exp Str=userinfogo.f_apartment}" />							
					<o:PropertySetter PropertyName="f_phone" NoDependValue="{m:Exp Str=userinfogo.f_phone}" />							
					<o:PropertySetter PropertyName="f_credentials" NoDependValue="{m:Exp Str=userinfogo.f_credentials}" />							
					<o:PropertySetter PropertyName="f_idnumber" NoDependValue="{m:Exp Str=userinfogo.f_idnumber}" />							
					<o:PropertySetter PropertyName="f_inputtor" NoDependValue="{m:Exp Str=userinfogo.f_inputtor}" />							
					<o:PropertySetter PropertyName="f_inputtorphone" NoDependValue="{m:Exp Str=userinfogo.f_inputtorphone}" />							
					<o:PropertySetter PropertyName="f_payment" NoDependValue="{m:Exp Str=userinfogo.f_payment}" />							
					<o:PropertySetter PropertyName="f_gasproperties" NoDependValue="{m:Exp Str=userinfogo.f_gasproperties}" />							
					<o:PropertySetter PropertyName="f_stairtype" NoDependValue="{m:Exp Str=userinfogo.f_stairtype}" />							
					<o:PropertySetter PropertyName="f_stair1price" NoDependValue="{m:Exp Str=userinfogo.f_stair1price}" />							
					<o:PropertySetter PropertyName="f_bankname" NoDependValue="{m:Exp Str=userinfogo.f_bankname}" />							
					<o:PropertySetter PropertyName="f_idofcard" NoDependValue="{m:Exp Str=userinfogo.f_idofcard}" />	
					<o:PropertySetter  PropertyName="f_orgstr" Default="{m:Exp Str=LoginUser.orgpathstr}"/>	
					<o:PropertySetter  PropertyName="f_filiale" Default="{m:Exp Str=LoginUser.f_fengongsi}"/>	
					<o:PropertySetter  PropertyName="f_sgoperator" Default="{m:Exp Str=LoginUser.name}"/>										
			</o:GeneralObject>
		 </m:ResourceLoad>
        <Grid  x:Name="LayoutRoot1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="0.4*"/>
                <ColumnDefinition Width="0.6*"/>
            </Grid.ColumnDefinitions>
            <c:BusyIndicatorEx BusyContent="正在查询，请稍等" IsBusy="{m:Exp Str=areafiles.ItemsSource.IsBusy}" >
                         <toolkit:DockPanel Width="Auto" >
                            <toolkit:DockPanel   Background="{x:Null}" toolkit:DockPanel.Dock="Bottom" Margin="0,0,0,5" Height="22">
                                <TextBlock TextWrapping="Wrap" Text="{m:Exp Str=$共\{areafiles.ItemsSource.Count\}项}" Width="Auto" HorizontalAlignment="Right" Foreground="#FF140000" VerticalAlignment="Bottom" Margin="0,0,0,1"/>
                                <sdk:DataPager x:Name="pager" Source="{Binding ItemsSource.Count, Converter={StaticResource DataPagerConverter}, ElementName=areafiles}"  Margin="0,0,0,-2" PageSize="20"/>
                            </toolkit:DockPanel>
                            <toolkit:DockPanel  x:Name="areafilesearch1" toolkit:DockPanel.Dock="Top"  Margin="0,0,0,5" Background="#FFEAF8FF"  >
                                <a:Data.Context>
                                    <o:SearchObject />
                                </a:Data.Context>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="70"/>
                                        <ColumnDefinition Width="50*"/>
                                        <ColumnDefinition Width="50*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="28"/>
                                        <RowDefinition Height="28"/>
                                    </Grid.RowDefinitions>
                                    <TextBlock TextWrapping="Wrap" Text="用户编号：" TextAlignment="Right"  Margin="5,4,0,4" />
                                    <TextBox TextWrapping="Wrap" Grid.Column="1" a:ControlAttach.UpdateOnEnter="Text" a:ControlAttach.DefaultButton="areasearchbutton" Text="{m:Bind Path=f_userid}" Width="Auto" Margin="0" Height="25" >
                                        <a:Data.Prop>
                                            <o:PropertySetter PropertyName="f_userid"  Operator="f_userid like '%this%'"/>
                                        </a:Data.Prop>
                                    </TextBox>
                                    <TextBlock TextWrapping="Wrap" Grid.Row="1" Text="用户姓名："  TextAlignment="Right" Margin="5,4,0,4" />
                                    <TextBox TextWrapping="Wrap" Grid.Row="1" a:ControlAttach.UpdateOnEnter="Text" a:ControlAttach.DefaultButton="areasearchbutton" Grid.Column="1" Text="{m:Bind Path=f_username}" Width="Auto" Margin="0" Height="25" >
                                        <a:Data.Prop>
                                            <o:PropertySetter PropertyName="f_username"  Operator="f_username like '%this%'"/>
                                        </a:Data.Prop>
                                    </TextBox>
                                    <Button Content="查  询" x:Name="areasearchbutton" Grid.Column="2" Grid.Row="1" Click="{m:Exp Str=areafilesearch1.DataContext.Search()}" Margin="0,0,3,4" HorizontalAlignment="Right" Width="73" VerticalAlignment="Bottom"/>
                                </Grid>
                            </toolkit:DockPanel>
                            <sdk:DataGrid x:Name="areafiles" Margin="0" 
							AutoGenerateColumns="False" Width="Auto" Background="{x:Null}" IsReadOnly="True">
								<a:Data.Items>
									<o:PagedObjectList WebClientInfo="{StaticResource dbclient}"
										MultiPath="{m:Exp Str=$from t_userinfo where \{areafilesearch1.DataContext.Condition\} and f_userstate\=\'正常\' and f_filiale\=\'\{LoginUser.f_fengongsi\}\'}"
										Path="{m:Exp Str=$from t_userinfo where \{areafilesearch1.DataContext.Condition\} and f_userstate\=\'正常\' and f_filiale\=\'\{LoginUser.f_fengongsi\}\' order by f_yytdate desc\,f_yyttime desc}"
										IsOld="{m:Exp Str=SaveAction.State\=\=$End$}"
										PageIndex="{m:Exp Str=pager.PageIndex}" PageSize="{m:Exp Str=pager.PageSize}" SumNames=","/>
								</a:Data.Items>
                                <sdk:DataGrid.Columns>
                                    <sdk:DataGridTextColumn d:IsLocked="True" Header="序  号" Binding="{Binding Index}"/>
									<sdk:DataGridTextColumn Header="用户编号" Binding="{Binding f_userid}"/>
									<sdk:DataGridTextColumn Header="用户姓名" Binding="{Binding f_username}"/>
									<sdk:DataGridTextColumn Header="地址" Binding="{Binding f_address}"/>
									<sdk:DataGridTextColumn Header="门牌号" Binding="{Binding f_apartment}"/>
									<sdk:DataGridTextColumn Header="电话" Binding="{Binding f_phone}"/>
									<sdk:DataGridTextColumn Header="建档日期" Binding="{Binding f_yytdate,StringFormat=yyyy-MM-dd}"/>
									<sdk:DataGridTextColumn Header="建档时间" Binding="{Binding f_yyttime,StringFormat=HH:mm:ss}"/>
                                </sdk:DataGrid.Columns>
                            </sdk:DataGrid>
                        </toolkit:DockPanel>
            </c:BusyIndicatorEx>
            <c:BusyIndicatorEx x:Name="ui_userfile" BusyContent="正在工作，请稍等" IsBusy="{m:Exp Str=userinfogo.IsBusy or SaveAction.IsBusy}"  Margin="5,0,0,0" Grid.Column="1" >
                <toolkit:DockPanel>
                   
                        <Grid x:Name="userfile" >
                            <Grid.RowDefinitions>
                                <RowDefinition Height="0.45*"/>
                                <RowDefinition Height="0.45*"/>
                                <RowDefinition Height="0.10*"/>
                            </Grid.RowDefinitions>
                            <c:BusyIndicatorEx  >
                                        <Grid Margin="0" DataContext="{m:Exp Str=userfileschangeset}" HorizontalAlignment="Stretch" >
                                           
											<Grid.Background>
                                                <LinearGradientBrush EndPoint="0.5,1" MappingMode="RelativeToBoundingBox" StartPoint="0.5,0">
                                                    <GradientStop Color="#FFF2F8FF" Offset="0"/>
                                                    <GradientStop Color="#FFDDF2FD" Offset="1"/>
                                                </LinearGradientBrush>
                                            </Grid.Background>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="30"/>
                                                <RowDefinition Height="30"/>
                                                <RowDefinition Height="30"/>
                                                <RowDefinition Height="30"/>
                                                <RowDefinition Height="30"/>
                                                <RowDefinition Height="30"/>
                                                <RowDefinition Height="30"/>
                                                <RowDefinition Height="30"/>
                                                <RowDefinition Height="30"/>
                                                <RowDefinition Height="30"/>
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="100"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="100"/>
                                                <ColumnDefinition Width="0"/>
                                                <ColumnDefinition Width="0"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="100"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <TextBlock Text="用户编号：" Margin="0,3,0,2" Grid.Row="1" Grid.Column="0"  TextWrapping="Wrap" TextAlignment="Right"/>
                                            <TextBlock Text="用户名称：" Margin="0,3,0,2" Grid.Row="1" TextWrapping="Wrap" TextAlignment="Right" Grid.Column="2"/>
                                            <TextBox Text="{m:Bind Path=f_usernamechange}"  Grid.Column="3" Margin="0,2,-0.333,3" Grid.Row="1"  Grid.ColumnSpan="5"  TextWrapping="Wrap" Height="Auto" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Width="Auto" Grid.RowSpan="1" IsReadOnly="True" >
                                                <a:Data.Prop>
                                                    <o:PropertySetter PropertyName="f_usernamechange" NotNull="True"  NoDependValue="{m:Exp Str=userinfogo.f_username}" />
                                                </a:Data.Prop>
                                            </TextBox>
                                            <ComboBox x:Name="CoboxPinp_Copy3" ItemsSource="{m:Exp Str=zhengjianlist}" DisplayMemberPath="name" SelectedValuePath="name" SelectedValue="{m:Bind Path=f_credentialschange}" Grid.Column="3" Margin="0,3,99.667,2" Grid.Row="4" IsEnabled="true" FontSize="13.333" RenderTransformOrigin="-5.111,4.2" Grid.ColumnSpan="4">
                                                <a:Data.Prop>
                                                    <o:PropertySetter PropertyName="f_credentialschange"  NotNull="True" NoDependValue="{m:Exp Str=userinfogo.f_credentials}"/>
                                                </a:Data.Prop>
                                            </ComboBox>
                                            <TextBlock Text="楼层：" Margin="0.333,3,0,2" TextWrapping="Wrap" TextAlignment="Right" Grid.Row="2" Grid.Column="6"/>
                                            <TextBox Text="{m:Bind Path=f_cusFloorchange}"  Grid.Column="7" Margin="1.333,2,-0.333,1" Grid.Row="2" TextWrapping="Wrap" Height="27" VerticalAlignment="Center" Grid.ColumnSpan="1" IsReadOnly="False" HorizontalAlignment="Stretch" Width="Auto"  Grid.RowSpan="1" >
                                                <a:Data.Prop>
                                                    <o:PropertySetter PropertyName="f_cusFloorchange" NotNull="True"  NoDependValue="{m:Exp Str=userinfogo.f_cusFloor}" />
                                                </a:Data.Prop>
                                            </TextBox>
                                            <TextBox Text="{m:Bind Path=f_userid}"  Grid.Column="1" Margin="0,0,0,2" Grid.Row="1" TextWrapping="Wrap"  Height="Auto" VerticalAlignment="Stretch" Grid.ColumnSpan="1" IsReadOnly="True" Grid.RowSpan="1" >
                                                <a:Data.Prop>
                                                    <o:PropertySetter PropertyName="f_userid" NotNull="True" NoDependValue="{m:Exp Str=userinfogo.f_userid}" />
                                                </a:Data.Prop>
                                            </TextBox>

                                            <TextBlock Text="小区名称：" Margin="0,3,0,2" TextWrapping="Wrap" TextAlignment="Right" Grid.Row="2" Grid.Column="0" />
                                            <TextBox Text="{m:Bind Path=f_districtnamechange}" x:Name="f_linkname" Grid.Column="1"  Grid.Row="2"  Margin="0,3,2,0"  Grid.ColumnSpan="1" TextWrapping="Wrap" Height="25" VerticalAlignment="Top" HorizontalAlignment="Stretch" Width="Auto">
                                                <a:Data.Prop>
                                                    <o:PropertySetter PropertyName="f_districtnamechange"  NotNull="True"   NoDependValue="{m:Exp Str=userinfogo.f_districtname}"/>
                                                </a:Data.Prop>
                                            </TextBox>
                                            <TextBlock Text="门 牌 号：" TextWrapping="Wrap" TextAlignment="Right" Grid.Row="3" Grid.Column="6" Margin="0.333,0,0,0" VerticalAlignment="Center"/>
                                            <TextBox Text="{m:Bind Path=f_apartmentchange}" x:Name="f_apartment"  Grid.Column="7" Margin="0.333,3,-0.333,2" Grid.Row="3" TextWrapping="Wrap"  Height="Auto" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Width="Auto" Grid.RowSpan="1" Grid.ColumnSpan="1"  >
                                                <a:Data.Prop>
                                                    <o:PropertySetter PropertyName="f_apartmentchange"  NotNull="True"  NoDependValue="{m:Exp Str=userinfogo.f_apartment}"/>
                                                </a:Data.Prop>
                                            </TextBox>
                                            <TextBlock Text="地址：" Margin="0,4,0,1" Grid.Row="3" TextWrapping="Wrap" TextAlignment="Right" />
                                            <TextBox Text="{m:Bind Path=f_addresschange}"  Grid.Column="1" Margin="0,4,99.667,1" Grid.Row="3" TextWrapping="Wrap" Height="Auto" VerticalAlignment="Stretch" IsReadOnly="False" Grid.ColumnSpan="6" >
                                                <a:Data.Prop>
                                                    <o:PropertySetter PropertyName="f_addresschange" NotNull="True"  NoDependValue="{m:Exp Str=userinfogo.f_address}"/>
                                                </a:Data.Prop>
                                            </TextBox>
                                            <TextBlock Margin="0,6,0,5" TextWrapping="Wrap" Text="抄表员：" TextAlignment="Right" Grid.Row="5" HorizontalAlignment="Right" VerticalAlignment="Center" Height="19" Width="52"/>
                                            <ComboBox x:Name="CoboxInputtor" ItemsSource="{m:Exp Str=inputtorlist}" DisplayMemberPath="f_inputtor" SelectedValuePath="f_inputtor" SelectedValue="{m:Bind Path=f_inputtorchange}" Grid.Column="1" Margin="0,3,0,2" Grid.Row="5" IsEnabled="true" FontSize="13.333">
                                               <a:Data.Prop>
													<o:PropertySetter PropertyName="f_inputtorchange"  NoDependValue="{m:Exp Str=userinfogo.f_inputtor}"/>
												</a:Data.Prop> 
                                            </ComboBox>
                                            <TextBlock Text="电话：" Margin="0,3,0,2" Grid.Row="4" TextWrapping="Wrap" TextAlignment="Right"/>
                                            <ComboBox x:Name="CoboxGasPro" ItemsSource="{m:Exp Str=usegaslist}" DisplayMemberPath="name" SelectedValuePath="name" SelectedValue="{m:Bind Path=f_gaspropertieschange}"  Grid.Column="1" Margin="0,4,0,1" Grid.Row="6" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Width="Auto">
                                                <a:Data.Prop>
                                                    <o:PropertySetter PropertyName="f_gaspropertieschange" NotNull="True" NoDependValue="{m:Exp Str=userinfogo.f_gasproperties\=>DataLoaded}" />
                                                </a:Data.Prop>
                                            </ComboBox>
                                            <TextBlock Grid.Row="4" TextWrapping="Wrap" Text="证件类型：" TextAlignment="Right" Margin="0,5,0,0" Grid.Column="2"/>
                                            <ComboBox x:Name="CoboxStair"  DisplayMemberPath="f_stairtype" SelectedValuePath="f_stairtype" SelectedValue="{m:Bind Path=f_stairtypechange}" ItemsSource="{m:Exp Str=stairl}" Margin="0" Grid.Row="6" Grid.Column="3" Grid.ColumnSpan="3"  VerticalAlignment="Center"   >
                                                <a:Data.Prop>
                                                    <o:PropertySetter PropertyName="f_stairtypechange" NoDependValue="{m:Exp Str=userinfogo.f_stairtype\=>DataLoaded}" NotNull="True"/>
                                                </a:Data.Prop>
                                            </ComboBox>
                                            <TextBlock Text="单元：" Margin="0,3,0,2" Grid.Row="2" TextWrapping="Wrap" TextAlignment="Right" Grid.Column="2"/>
                                            <TextBlock Text="证件号码：" Margin="0.333,4,0,1" Grid.Row="4" Grid.Column="6" TextWrapping="Wrap" TextAlignment="Right" />
                                            <TextBox Text="{m:Bind Path=f_idnumberchange}"  Grid.Column="7" Margin="0.333,4,-0.333,1" Grid.Row="4" TextWrapping="Wrap" Height="Auto" VerticalAlignment="Stretch" IsReadOnly="False" Grid.ColumnSpan="1" >
                                            	<a:Data.Prop>
                                            		<o:PropertySetter PropertyName="f_idnumberchange" NotNull="True" NoDependValue="{m:Exp Str=userinfogo.f_idnumber}" />
                                            	</a:Data.Prop>
                                            </TextBox>
                                            <TextBlock Text="抄表员电话：" Margin="0,2,0,3" Grid.Row="5" TextWrapping="Wrap" TextAlignment="Right" Grid.Column="2"/>
                                            <TextBox Text="{m:Bind Path=f_inputtorphonechange}" Grid.Column="3"  Grid.Row="5" TextWrapping="Wrap" Grid.ColumnSpan="3" Height="Auto" VerticalAlignment="Center" Grid.RowSpan="1" IsReadOnly="True" >
                                            	 <a:Data.Prop>
                                                <o:PropertySetter PropertyName="f_inputtorphonechange"  NoDependValue="{m:Exp Str=CoboxInputtor.SelectedItem.f_phone}"/>
                                            </a:Data.Prop>
                                            </TextBox>
                                            <TextBlock Margin="0,3,1,2" Grid.Row="5" TextWrapping="Wrap" Text="交费类型：" TextAlignment="Right" Height="25" Grid.Column="6"/>
                                            <ComboBox x:Name="CoboxPin" ItemsSource="{m:Exp Str=jiaofeilist}" DisplayMemberPath="name" SelectedValuePath="name" SelectedValue="{m:Bind Path=f_paymentchange}" Margin="0,3,0,2" Grid.Row="5" Height="25" RenderTransformOrigin="-1.216,1.72" Grid.Column="7">
                                            	<a:Data.Prop>
                                            		<o:PropertySetter PropertyName="f_paymentchange"  NoDependValue="{m:Exp Str=userinfogo.f_payment\=>DataLoaded}" NotNull="True"/>
                                            	</a:Data.Prop>
                                            </ComboBox>
                                            <TextBox Text="{m:Bind Path=f_idofcardchange}" Grid.Column="3" Margin="0.333,3,0,2" Grid.Row="8" TextWrapping="Wrap" Height="25" VerticalAlignment="Center" RenderTransformOrigin="-1.739,-0.923" HorizontalAlignment="Stretch" Width="Auto" Grid.ColumnSpan="3" Grid.RowSpan="1" >
												<a:Data.Prop>
                                            		<o:PropertySetter PropertyName="f_idofcardchange" NoDependValue="{m:Exp Str=userinfogo.f_idofcard\=>DataLoaded}"  ValidationVal="{m:Exp Str=userfileschangeset.f_idofcard!\=null or userfileschangeset.f_payment!\=$银行代扣$}" ErrorMessage="银行账号不能为空！"/>
                                            	</a:Data.Prop>
											</TextBox>
                                            <TextBlock Margin="0,6,0,5" TextWrapping="Wrap" Text="银行账号：" TextAlignment="Right" Grid.Row="8" VerticalAlignment="Center" Height="19" Width="71" Grid.Column="2" HorizontalAlignment="Right"/>
                                            <TextBlock Margin="0,6,0,5" TextWrapping="Wrap" Text="开户银行：" TextAlignment="Right" Grid.Row="8" VerticalAlignment="Center"/>
                                            <ComboBox DisplayMemberPath="name" SelectedValuePath="name" SelectedValue="{m:Bind Path=f_banknamechange}"  Grid.Column="1" Margin="0,4,0,3" Grid.Row="8"  Height="Auto" VerticalAlignment="Center" RenderTransformOrigin="-1.739,-0.923" HorizontalAlignment="Stretch" Width="Auto" Grid.ColumnSpan="1" Grid.RowSpan="1">
                                            	<a:Data.Items>
                                            		<o:ObjectList WebClientInfo="{StaticResource dbclient}"  Path="from paramvalue where param.name='银行名'"/>
                                            	</a:Data.Items>
                                            	<a:Data.Prop>
                                            		<o:PropertySetter PropertyName="f_banknamechange" NoDependValue="{m:Exp Str=userinfogo.f_bankname\=>DataLoaded}" ValidationVal="{m:Exp Str=userfileschangeset.f_bankname!\=null or userfileschangeset.f_payment!\=$银行代扣$}" ErrorMessage="开户银行不能为空！"/>
                                            	</a:Data.Prop>
                                            </ComboBox>
                                            <sdk:Label Margin="0,6,0,5" Content="银行信息"  Grid.Row="7" HorizontalAlignment="Left" VerticalAlignment="Center" Height="19" Width="160" Grid.ColumnSpan="3" Grid.Column="1" FontSize="13.333" FontWeight="Bold" />
                                            <sdk:Label Margin="0,6,0,5" Content="基本信息" HorizontalAlignment="Left" VerticalAlignment="Center" Height="19" Width="160" Grid.ColumnSpan="2" Grid.Column="1" FontSize="13.333" FontWeight="Bold" />
                                            <TextBox Text="{m:Bind Path=f_cusDychange}"  Grid.Column="3" Margin="0.944,0,0,1" Grid.Row="2" TextWrapping="Wrap" Height="27" VerticalAlignment="Bottom" Grid.ColumnSpan="3" IsReadOnly="False" HorizontalAlignment="Stretch" Width="Auto"  Grid.RowSpan="1" >
                                            	<a:Data.Prop>
                                            		<o:PropertySetter PropertyName="f_cusDychange"  NoDependValue="{m:Exp Str=userinfogo.f_cusDy}" />
                                            	</a:Data.Prop>
                                            </TextBox>
                                            <TextBox Text="{m:Bind Path=f_phonechange}"  Grid.Column="1"  Grid.Row="4" TextWrapping="Wrap" Height="Auto" VerticalAlignment="Center" IsReadOnly="False" Grid.ColumnSpan="1" >
                                            	<a:Data.Prop>
                                            		<o:PropertySetter PropertyName="f_phonechange" NoDependValue="{m:Exp Str=userinfogo.f_phone}" />
                                            	</a:Data.Prop>
                                            </TextBox>
                                            <TextBlock Margin="0,6,0,5" TextWrapping="Wrap" Text="用气性质：" TextAlignment="Right" Grid.Row="6" HorizontalAlignment="Right" VerticalAlignment="Center" Height="19"/>
                                            <TextBlock Text="阶梯气价类型：" Margin="0,2,0,3" Grid.Row="6" TextWrapping="Wrap" TextAlignment="Right" Grid.Column="2"/>
                                            <TextBlock Text="一阶气价：" Margin="0" Grid.Row="6" Grid.Column="6" TextWrapping="Wrap" TextAlignment="Right" VerticalAlignment="Center" />
                                            <TextBox Text="{m:Bind Path=f_stair1pricechange}"  Grid.Column="7" Margin="0,0,0,1" Grid.Row="6" TextWrapping="Wrap" Height="Auto" VerticalAlignment="Center" IsReadOnly="True" Grid.ColumnSpan="1" >
                                            	<a:Data.Prop>
                                            		<o:PropertySetter PropertyName="f_stair1pricechange" NotNull="True" NoDependValue="{m:Exp Str=CoboxStair.SelectedItem.f_stair1price}"  />
                                            	</a:Data.Prop>
                                            </TextBox>
                                        </Grid> 
                            </c:BusyIndicatorEx>
                            <c:BusyIndicatorEx  Grid.Row="1"  >
                                <sdk:TabControl>
                                    <sdk:TabItem Header="   设备信息   ">
                                        <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto" Width="Auto">
                                        <Grid Margin="0" HorizontalAlignment="Stretch"  >
                                        	<Grid.ColumnDefinitions>
                                        		<ColumnDefinition Width="*"/>
                                        		<ColumnDefinition Width="70"/>
                                        	</Grid.ColumnDefinitions>
                                            <Button  Content="添加设备" Click="{m:Exp Str=devicelist.AddEmpty()}" Width="60" HorizontalAlignment="Left" Margin="5,2,0,2" Grid.Column="1" VerticalAlignment="Top" />
											<sdk:DataGrid x:Name="areafiles2" Margin="0,0,0,0" ItemsSource="{m:Exp Str=devicelist}"  AutoGenerateColumns="False" Width="Auto" Background="{x:Null}" IsReadOnly="True">
                                                <sdk:DataGrid.Columns>
													<sdk:DataGridTemplateColumn Header="序 号" d:IsLocked="True" >
														<sdk:DataGridTemplateColumn.CellTemplate>
															<DataTemplate>
																<TextBox Text="{m:Exp Str=data\=\=data.List.EmptyRow:$*$\,data.Index}" Style="{StaticResource TextBoxDatagridStyle}" IsReadOnly="True"/> 
															</DataTemplate>
														</sdk:DataGridTemplateColumn.CellTemplate>
													</sdk:DataGridTemplateColumn>
													<sdk:DataGridTemplateColumn Header="设备名称">
														<sdk:DataGridTemplateColumn.CellTemplate>
															<DataTemplate>
																<ComboBox  DisplayMemberPath="name" SelectedValuePath="name" SelectedValue="{m:Bind Path=f_name}" ItemsSource="{m:Exp Str=shebeilist}"  Height="25">
																	<a:Data.Prop>
																		<o:PropertySetter PropertyName="f_name"   NotNull="True"/>
																	</a:Data.Prop> 
																</ComboBox>
															</DataTemplate>
														</sdk:DataGridTemplateColumn.CellTemplate>
													</sdk:DataGridTemplateColumn>
													<sdk:DataGridTemplateColumn Header="功 率">
														<sdk:DataGridTemplateColumn.CellTemplate>
															<DataTemplate>
																<TextBox Text="{m:Bind Path=f_heatingboiler_gonglu}" Style="{StaticResource TextBoxDatagridStyle}"/> 
															</DataTemplate>
														</sdk:DataGridTemplateColumn.CellTemplate>
													</sdk:DataGridTemplateColumn>
													<sdk:DataGridTemplateColumn Header="吨位/个数">
														<sdk:DataGridTemplateColumn.CellTemplate>
															<DataTemplate>
																<TextBox Text="{m:Bind Path=f_heatingboiler_tonnage}" Style="{StaticResource TextBoxDatagridStyle}"/> 
															</DataTemplate>
														</sdk:DataGridTemplateColumn.CellTemplate>
													</sdk:DataGridTemplateColumn>
													<sdk:DataGridTemplateColumn Header="台 数">
														<sdk:DataGridTemplateColumn.CellTemplate>
															<DataTemplate>
																<TextBox Text="{m:Bind Path=f_heatingboiler_quantity}" Style="{StaticResource TextBoxDatagridStyle}"/> 
															</DataTemplate>
														</sdk:DataGridTemplateColumn.CellTemplate>
													</sdk:DataGridTemplateColumn>
													<sdk:DataGridTemplateColumn Header="选择品牌">
														<sdk:DataGridTemplateColumn.CellTemplate>
															<DataTemplate>
																<TextBox Text="{m:Bind Path=f_heatingboiler_brand}" Style="{StaticResource TextBoxDatagridStyle}"/> 
															</DataTemplate>
														</sdk:DataGridTemplateColumn.CellTemplate>
													</sdk:DataGridTemplateColumn>
													<sdk:DataGridTemplateColumn Header="选择型号">
														<sdk:DataGridTemplateColumn.CellTemplate>
															<DataTemplate>
																<TextBox Text="{m:Bind Path=f_heatingboiler_model}" Style="{StaticResource TextBoxDatagridStyle}"/> 
															</DataTemplate>
														</sdk:DataGridTemplateColumn.CellTemplate>
													</sdk:DataGridTemplateColumn> 
													<sdk:DataGridTemplateColumn>
														<sdk:DataGridTemplateColumn.CellTemplate>
															<DataTemplate>
                                                                <Button Content="删除"  Click="{m:Exp Str=data.Remove()}"/>	
															</DataTemplate>
														</sdk:DataGridTemplateColumn.CellTemplate>
													</sdk:DataGridTemplateColumn>
												</sdk:DataGrid.Columns>
                                            </sdk:DataGrid> 
											</Grid></ScrollViewer>
                                    </sdk:TabItem>
                                </sdk:TabControl>
                            </c:BusyIndicatorEx>
                            <c:BusyIndicatorEx  Grid.Row="2" >
                                <!--按钮-->
                                <toolkit:DockPanel toolkit:DockPanel.Dock="Bottom" HorizontalAlignment="Center" VerticalAlignment="Center" >
                                    <Button x:Name="save"   Content="保存" IsEnabled="{m:Exp Str=!(userfileschangeset.HasErrors or devicelist.HasErrors)}" Click="{m:Exp Str=userinfogo.f_device\=devicelist;SaveAction.Invoke()}" Margin="5"  Width="83" />
                                    <Button x:Name="cancel" Content="清空" Click="{m:Exp Str=userfileschangeset.New();userinfogo.New()}" Margin="5"  Width="60"/>
                                </toolkit:DockPanel>
                            </c:BusyIndicatorEx>
                        </Grid>

                </toolkit:DockPanel>
            </c:BusyIndicatorEx>
        </Grid>
    <c:MessageTipObj IsShow="{m:Exp Str=userinfogo.State\=\=$Error$}" Type="MessageBox" Tip="保存失败！"/>
    </Grid>
</UserControl>
